<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>practica11</title><meta name="description" content="Documentation for practica11"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script async src="assets/search.js" id="search-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os"</script><header class="tsd-page-toolbar">
<div class="tsd-toolbar-contents container">
<div class="table-cell" id="tsd-search" data-base=".">
<div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M15.7824 13.833L12.6666 10.7177C12.5259 10.5771 12.3353 10.499 12.1353 10.499H11.6259C12.4884 9.39596 13.001 8.00859 13.001 6.49937C13.001 2.90909 10.0914 0 6.50048 0C2.90959 0 0 2.90909 0 6.49937C0 10.0896 2.90959 12.9987 6.50048 12.9987C8.00996 12.9987 9.39756 12.4863 10.5008 11.6239V12.1332C10.5008 12.3332 10.5789 12.5238 10.7195 12.6644L13.8354 15.7797C14.1292 16.0734 14.6042 16.0734 14.8948 15.7797L15.7793 14.8954C16.0731 14.6017 16.0731 14.1267 15.7824 13.833ZM6.50048 10.499C4.29094 10.499 2.50018 8.71165 2.50018 6.49937C2.50018 4.29021 4.28781 2.49976 6.50048 2.49976C8.71001 2.49976 10.5008 4.28708 10.5008 6.49937C10.5008 8.70852 8.71314 10.499 6.50048 10.499Z" fill="var(--color-text)"></path></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div>
<div class="field">
<div id="tsd-toolbar-links"></div></div>
<ul class="results">
<li class="state loading">Preparing search index...</li>
<li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">practica11</a></div>
<div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="1" y="3" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="7" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="11" width="14" height="2" fill="var(--color-text)"></rect></svg></a></div></div></header>
<div class="container container-main">
<div class="col-8 col-content">
<div class="tsd-page-title">
<h2>practica11</h2></div>
<div class="tsd-panel tsd-typography">
<a href="#práctica-12-destravate-api-nodeexpress" id="práctica-12-destravate-api-nodeexpress" style="color: inherit; text-decoration: none;">
  <h1><a href="https://github.com/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct07-destravate-datamodel-grupof.git">PRÁCTICA 12. DESTRAVATE: API NODE/EXPRESS</a>.</h1>
</a>
<p><a href="https://coveralls.io/github/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct07-destravate-datamodel-grupof?branch=main"><img src="https://coveralls.io/repos/github/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct07-destravate-datamodel-grupof/badge.svg?branch=main" alt="Coverage Status"></a></p>
<p><a href="https://github.com/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct07-destravate-datamodel-grupof/actions/workflows/coveralls.yml"><img src="https://github.com/ULL-ESIT-INF-DSI-2223/ull-esit-inf-dsi-22-23-prct07-destravate-datamodel-grupof/actions/workflows/coveralls.yml/badge.svg" alt="Coveralls"></a></p>

<a href="#carla-oval-torres-jairo-alonso-abreu-gabi-vacaru" id="carla-oval-torres-jairo-alonso-abreu-gabi-vacaru" style="color: inherit; text-decoration: none;">
  <h2>Carla Oval Torres, Jairo Alonso Abreu, Gabi Vacaru.</h2>
</a>

<a href="#índice-" id="índice-" style="color: inherit; text-decoration: none;">
  <h2>Índice <a name="índice"></a></h2>
</a>
<ol>
<li><a href="#introducci%C3%B3n">Introducción</a></li>
<li><a href="#requisitos">Descripción de los requisitos del sistema</a></li>
<li><a href="#funcionamiento">Funcionamiento</a><ol>
<li>Schemas/Modelos(#schemas)</li>
<li>Rutas(#rutas)</li>
<li>Controladores(#controladores)</li>
<li>Tests(#tests)</li>
<li>Despliegue(#despliegue)</li>
</ol>
</li>
<li><a href="#conclusiones">Conclusiones</a></li>
<li><a href="#referencias">Referencias</a></li>
</ol>

<a href="#introducción-" id="introducción-" style="color: inherit; text-decoration: none;">
  <h2>Introducción <a name="introducción"></a></h2>
</a>
<blockquote>
<p><a href="#%C3%ADndice">Volver al índice</a></p>
</blockquote>
<p>En esta práctica, la segunda grupal de la asignatura, tendrá que implementar un API REST, haciendo uso de Node/Express, que permita llevar a cabo operaciones de creación, lectura, modificación y borrado (Create, Read, Update, Delete - CRUD) de un registro de actividades deportivas.</p>
<p>Todo el código desarrollado deberá estar alojado en el repositorio generado tras la aceptación de la asignación grupal de GitHub Classroom. En ese sentido, utilice en dicho repositorio una estructura de proyecto similar a la que hemos visto en clase.</p>
<p>Además, tendrá que comentar en un informe la solución diseñada, haciendo hincapié en las decisiones de diseño que ha implementado.</p>
<p>Deberá utilizar MongoDB/MongoDB Atlas como sistema de base de datos no relacional, además de Mongoose, para gestionar la base de datos desde Node.js. Además, utilice las opciones y validadores que estime oportunos en sus esquemas.</p>
<p>Deberá desplegar el API en cyclic. En las últimas sesiones de teoría, veremos un ejemplo sencillo que ilustrará lo anterior.</p>
<p>Por último, deberá grabar un vídeo de 10 minutos de duración máxima, en el que todos los miembros del grupo deben intervenir. El objetivo del vídeo es llevar a cabo una descripción de todas las fases del desarrollo: código fuente implementado, documentación, pruebas, integración continua, calidad del código y despliegue.</p>

<a href="#descripción-de-los-requisitos-del-sistema-" id="descripción-de-los-requisitos-del-sistema-" style="color: inherit; text-decoration: none;">
  <h2>Descripción de los requisitos del sistema <a name="requisitos"></a></h2>
</a>
<blockquote>
<p><a href="#%C3%ADndice">Volver al índice</a></p>
</blockquote>
<blockquote>
<p>A continuación, se enumeran algunos requisitos que deberá cumplir el API, en lo que respecta a las diferentes rutas o puntos de acceso JSON que deberá proporcionar.</p>
<p>Track</p>
<p>En la ruta /tracks del API, se deberá poder crear, leer, actualizar o borrar una ruta (deportiva) a través de los métodos HTTP necesarios.
Para cada ruta incluida dentro del sistema, se debe almacenar la información siguiente:</p>
<ol>
<li>ID único de la ruta.</li>
<li>Nombre de la ruta.</li>
<li>Geolocalización del inicio (coordenadas).</li>
<li>Geolocalización del final de la ruta (coordenadas).</li>
<li>Longitud de la ruta en kilómetros.</li>
<li>Desnivel medio de la ruta.</li>
<li>Usuarios que han realizado la ruta (IDs).</li>
<li>Tipo de actividad: Indicador si la ruta se puede realizar en bicicleta o corriendo.</li>
<li>Calificación media de la ruta.</li>
</ol>
<p>La operación de lectura o consulta podrá llevarse a cabo de dos maneras diferentes: o bien utilizando una query string donde se consulte por el nombre de la ruta deportiva, o bien utilizando el identificador único de la ruta como parámetro. Las operaciones de modificación y borrado de una ruta también se podrán llevar a cabo de ambos modos.</p>
<p>Usuarios</p>
<p>En la ruta /users del API, se deberá poder crear, leer, actualizar o borrar un usuario a través de los métodos HTTP necesarios.
Dentro del sistema, necesitamos la siguiente información de los usuarios:</p>
<ol>
<li>ID único del usuario (puede ser un username creado por el usuario en el registro o un valor generado automáticamente por el sistema).</li>
<li>Nombre del usuario.</li>
<li>Actividades que realiza: Correr o bicicleta.</li>
<li>Amigos en la aplicación: Colleción de IDs de usuarios con los que interacciona.</li>
<li>Grupos de amigos: Diferentes colecciones de IDs de usuarios con los que suele realizar rutas.</li>
<li>Estadísticas de entrenamiento: Cantidad de km y desnivel total acumulados en la semana, mes y año.</li>
<li>Rutas favoritas: IDs de las rutas que el usuario ha realizado con mayor frecuencia.</li>
<li>Retos activos: IDs de los retos que el usuario está realizando actualmente.</li>
<li>Histórico de rutas: Los usuarios deben almacenar el historial de rutas realizadas desde que se registraron en el sistema. La información almacenada en esta estructura de datos deberá contener la información de la fecha y el ID de la ruta realizada. Nótese que un usuario puede realizar más de una ruta al día y está decisión puede afectar al tipo de estructura en el que se almacena la información.</li>
</ol>
<p>La operación de lectura o consulta podrá llevarse a cabo de dos maneras diferentes: o bien utilizando una query string donde se consulte por el nombre del usuario, o bien utilizando el identificador único del usuario como parámetro. Las operaciones de modificación y borrado de un usuario también se podrán llevar a cabo de ambos modos.</p>
<p>Grupos</p>
<p>En la ruta /groups del API, se deberá poder crear, leer, actualizar o borrar una grupo a través de los métodos HTTP necesarios.
Un grupo de usuarios engloba la información de los usuarios que se unen para realizar rutas juntos.</p>
<ol>
<li>ID único del grupo.</li>
<li>Nombre del grupo.</li>
<li>Participantes: IDs de los miembros del grupo.</li>
<li>Estadísticas de entrenamiento grupal: Cantidad de km y desnivel total acumulados de manera grupal en la semana, mes y año</li>
<li>Clasificación de los usuarios: Ranking de los usuarios que más entrenamientos han realizado históricamente dentro del grupo, es decir, ordenar los usuarios por la cantidad de km totales o desnivel total que han acumulado.</li>
<li>Rutas favoritas del grupo: Rutas que los usuarios del grupo han realizado con mayor frecuencia en sus salidas conjuntas.</li>
<li>Histórico de rutas realizadas por el grupo: Información similar que almacenan los usuarios pero en este caso referente a los grupos.</li>
</ol>
<p>Nótese que un usuario puede realizar rutas con un grupo y/o de manera individual el mismo día. Es decir, a modo de simplificación, asumimos que todos los usuarios de un grupo realizan la actividad cuando se planifica. Aunque, también pueden realizar otras actividades de manera individual.</p>
<p>La operación de lectura o consulta podrá llevarse a cabo de dos maneras diferentes: o bien utilizando una query string donde se consulte por el nombre del grupo, o bien utilizando el identificador único del grupo como parámetro. Las operaciones de modificación y borrado de una grupo también se podrán llevar a cabo de ambos modos.</p>
<p>Retos</p>
<p>En la ruta /challenges del API, se deberá poder crear, leer, actualizar o borrar una reto a través de los métodos HTTP necesarios.</p>
<p>Los retos serán otra entidad dentro del sistema. Esta entidad deberá contener toda la información asociada a objetivos de entrenamientos:</p>
<ol>
<li>ID único del reto.</li>
<li>Nombre del reto.</li>
<li>Rutas que forman parte del reto.</li>
<li>Tipo de actividad del reto: bicicleta o correr.</li>
<li>Km totales a realizar (como la suma de los kms de las rutas que lo engloban).</li>
<li>Usuarios que están realizando el reto.</li>
</ol>
</blockquote>
<p>La operación de lectura o consulta podrá llevarse a cabo de dos maneras diferentes: o bien utilizando una query string donde se consulte por el nombre del reto, o bien utilizando el identificador único del reto como parámetro. Las operaciones de modificación y borrado de un reto también se podrán llevar a cabo de ambos modos.</p>

<a href="#funcionamiento-" id="funcionamiento-" style="color: inherit; text-decoration: none;">
  <h3>Funcionamiento <a name="funcionamiento"></a></h3>
</a>
<blockquote>
<p><a href="#%C3%ADndice">Volver al índice</a></p>
</blockquote>
<blockquote>
<p>Esta API pretende funcionar como un sistema de gestión de rutas deportivas. Se utiliza el framework Express.js para la creación de la API, además, se ha utilizado la base de datos MongoDB para almacenar la información de la aplicación, y para la conexión con la base de datos, se ha utilizado el paquete mongoose. </p>
</blockquote>
<p>La estructura de nuestro código TypeScript es la siguiente:</p>
<pre><code class="language-bash"><span class="hl-0">.github</span><br/><span class="hl-0">coverage</span><br/><span class="hl-0">docs</span><br/><span class="hl-0">node_modules</span><br/><span class="hl-0">src</span><br/><span class="hl-0">├──</span><span class="hl-1"> </span><span class="hl-2">controllers</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">├──</span><span class="hl-1"> </span><span class="hl-2">challenge.controller.ts</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">├──</span><span class="hl-1"> </span><span class="hl-2">group.controller.ts</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">├──</span><span class="hl-1"> </span><span class="hl-2">track.controller.ts</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">└──</span><span class="hl-1"> </span><span class="hl-2">user.controller.ts</span><br/><span class="hl-0">├──</span><span class="hl-1"> </span><span class="hl-2">database</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">└──</span><span class="hl-1"> </span><span class="hl-2">mongoose.ts</span><br/><span class="hl-0">├──</span><span class="hl-1"> </span><span class="hl-2">index.ts</span><br/><span class="hl-0">├──</span><span class="hl-1"> </span><span class="hl-2">models</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">├──</span><span class="hl-1"> </span><span class="hl-2">challengeSchema.ts</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">├──</span><span class="hl-1"> </span><span class="hl-2">groupSchema.ts</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">├──</span><span class="hl-1"> </span><span class="hl-2">trackSchema.ts</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">└──</span><span class="hl-1"> </span><span class="hl-2">userSchema.ts</span><br/><span class="hl-0">├──</span><span class="hl-1"> </span><span class="hl-2">routes</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">├──</span><span class="hl-1"> </span><span class="hl-2">challengeRouter.ts</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">├──</span><span class="hl-1"> </span><span class="hl-2">groupRouter.ts</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">├──</span><span class="hl-1"> </span><span class="hl-2">trackRouter.ts</span><br/><span class="hl-0">│</span><span class="hl-1">   </span><span class="hl-2">└──</span><span class="hl-1"> </span><span class="hl-2">userRouter.ts</span><br/><span class="hl-0">├──</span><span class="hl-1"> </span><span class="hl-2">serverTest.ts</span><br/><span class="hl-0">└──</span><span class="hl-1"> </span><span class="hl-2">utils</span><br/><span class="hl-1">    </span><span class="hl-0">└──</span><span class="hl-1"> </span><span class="hl-2">functions.ts</span><br/><span class="hl-0">tests</span><br/><span class="hl-0">├──</span><span class="hl-1"> </span><span class="hl-2">challenge.spec.ts</span><br/><span class="hl-0">├──</span><span class="hl-1"> </span><span class="hl-2">group.spec.ts</span><br/><span class="hl-0">├──</span><span class="hl-1"> </span><span class="hl-2">track.spec.ts</span><br/><span class="hl-0">└──</span><span class="hl-1"> </span><span class="hl-2">user.spec.ts</span><br/><span class="hl-0">.gitignore</span><br/><span class="hl-0">package-lock.json</span><br/><span class="hl-0">package.json</span><br/><span class="hl-0">README.md</span><br/><span class="hl-0">tsconfig.json</span><br/><span class="hl-2">````</span><span class="hl-1">	</span><br/><br/><span class="hl-0">Donde</span><span class="hl-1"> </span><span class="hl-2">src</span><span class="hl-1"> </span><span class="hl-2">es</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">carpeta</span><span class="hl-1"> </span><span class="hl-2">donde</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">encuentra</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">código</span><span class="hl-1"> </span><span class="hl-2">fuente</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">aplicación,</span><span class="hl-1"> </span><span class="hl-2">tests</span><span class="hl-1"> </span><span class="hl-2">es</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">carpeta</span><span class="hl-1"> </span><span class="hl-2">donde</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">encuentra</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">código</span><span class="hl-1"> </span><span class="hl-2">fuente</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">tests,</span><span class="hl-1"> </span><span class="hl-2">docs</span><span class="hl-1"> </span><span class="hl-2">es</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">carpeta</span><span class="hl-1"> </span><span class="hl-2">donde</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">encuentra</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">documentación</span><span class="hl-1"> </span><span class="hl-2">generada</span><span class="hl-1"> </span><span class="hl-2">por</span><span class="hl-1"> </span><span class="hl-2">TypeDoc,</span><span class="hl-1"> </span><span class="hl-2">coverage</span><span class="hl-1"> </span><span class="hl-2">es</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">carpeta</span><span class="hl-1"> </span><span class="hl-2">donde</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">encuentra</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">información</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">cobertura</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">tests</span><span class="hl-1"> </span><span class="hl-2">y</span><span class="hl-1"> </span><span class="hl-2">node_modules</span><span class="hl-1"> </span><span class="hl-2">es</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">carpeta</span><span class="hl-1"> </span><span class="hl-2">donde</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">encuentran</span><span class="hl-1"> </span><span class="hl-2">las</span><span class="hl-1"> </span><span class="hl-2">dependencias</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">nuestro</span><span class="hl-1"> </span><span class="hl-2">proyecto.</span><br/><br/><span class="hl-0">Dentro</span><span class="hl-1"> </span><span class="hl-2">del</span><span class="hl-1"> </span><span class="hl-2">directorio</span><span class="hl-1"> </span><span class="hl-2">src,</span><span class="hl-1"> </span><span class="hl-2">tenemos</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">siguientes</span><span class="hl-1"> </span><span class="hl-2">directorios</span><span class="hl-1"> </span><span class="hl-2">y</span><span class="hl-1"> </span><span class="hl-2">ficheros:</span><br/><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">controllers:</span><span class="hl-1"> </span><span class="hl-2">contiene</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">controladores</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">aplicación.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">database:</span><span class="hl-1"> </span><span class="hl-2">contiene</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">fichero</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">configuración</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">base</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">datos.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">odels:</span><span class="hl-1"> </span><span class="hl-2">contiene</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">modelos</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">aplicación.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">routes:</span><span class="hl-1"> </span><span class="hl-2">contiene</span><span class="hl-1"> </span><span class="hl-2">las</span><span class="hl-1"> </span><span class="hl-2">rutas</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">aplicación.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">utils:</span><span class="hl-1"> </span><span class="hl-2">contiene</span><span class="hl-1"> </span><span class="hl-2">las</span><span class="hl-1"> </span><span class="hl-2">funciones</span><span class="hl-1"> </span><span class="hl-2">auxiliares</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">aplicación.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">index.ts:</span><span class="hl-1"> </span><span class="hl-2">fichero</span><span class="hl-1"> </span><span class="hl-2">principal</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">aplicación.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">serverTest.ts:</span><span class="hl-1"> </span><span class="hl-2">fichero</span><span class="hl-1"> </span><span class="hl-2">principal</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">tests.</span><br/><span class="hl-1"> </span><br/><br/><span class="hl-3">### Schemas/Modelos&lt;a name=&quot;schemas&quot;&gt;&lt;/a&gt;</span><br/><span class="hl-1">&gt; [Volver al índice](#índice)</span><br/><br/><span class="hl-1">&gt; </span><span class="hl-0">En</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">carpeta</span><span class="hl-1"> </span><span class="hl-2">models</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">encuentran</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">modelos</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">aplicación.</span><span class="hl-1"> </span><span class="hl-2">Estos</span><span class="hl-1"> </span><span class="hl-2">modelos</span><span class="hl-1"> </span><span class="hl-2">son</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">utilizan</span><span class="hl-1"> </span><span class="hl-2">para</span><span class="hl-1"> </span><span class="hl-2">crear</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">documentos</span><span class="hl-1"> </span><span class="hl-2">en</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">base</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">datos.</span><span class="hl-1"> </span><span class="hl-2">Los</span><span class="hl-1"> </span><span class="hl-2">modelos</span><span class="hl-1"> </span><span class="hl-2">son</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">siguientes:</span><br/><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">challengeSchema.ts:</span><span class="hl-1"> </span><span class="hl-2">modelo</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">retos.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">groupSchema.ts:</span><span class="hl-1"> </span><span class="hl-2">modelo</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">grupos.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">trackSchema.ts:</span><span class="hl-1"> </span><span class="hl-2">modelo</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">las</span><span class="hl-1"> </span><span class="hl-2">rutas.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">userSchema.ts:</span><span class="hl-1"> </span><span class="hl-2">modelo</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">usuarios.</span><br/><br/><span class="hl-0">A</span><span class="hl-1"> </span><span class="hl-2">contiuación</span><span class="hl-1"> </span><span class="hl-2">explicaremos</span><span class="hl-1"> </span><span class="hl-2">brevemente</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">estructura</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">cada</span><span class="hl-1"> </span><span class="hl-2">uno</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">modelos.</span><span class="hl-1"> </span><span class="hl-2">Adelantamos</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">para</span><span class="hl-1"> </span><span class="hl-2">cada</span><span class="hl-1"> </span><span class="hl-2">uno,</span><span class="hl-1"> </span><span class="hl-2">habrá</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">crearse</span><span class="hl-1"> </span><span class="hl-2">un</span><span class="hl-1"> </span><span class="hl-2">controlador,</span><span class="hl-1"> </span><span class="hl-2">una</span><span class="hl-1"> </span><span class="hl-2">ruta</span><span class="hl-1"> </span><span class="hl-2">y</span><span class="hl-1"> </span><span class="hl-2">un</span><span class="hl-1"> </span><span class="hl-2">test.</span><span class="hl-1"> </span><span class="hl-2">Además</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">proceso</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">creación</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">modelos</span><span class="hl-1"> </span><span class="hl-2">es</span><span class="hl-1"> </span><span class="hl-2">igual</span><span class="hl-1"> </span><span class="hl-2">para</span><span class="hl-1"> </span><span class="hl-2">todos:</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">crea</span><span class="hl-1"> </span><span class="hl-2">una</span><span class="hl-1"> </span><span class="hl-2">interfaz</span><span class="hl-1"> </span><span class="hl-2">con</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">campos</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">tendrá</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">modelo,</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">crea</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">modelo</span><span class="hl-1"> </span><span class="hl-2">y</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">exporta.</span><br/><br/><span class="hl-3">#### ChallengeSchema.ts &lt;a name=&quot;challengeSchema&quot;&gt;&lt;/a&gt;</span><br/><br/><span class="hl-1">&gt; El modelo de datos para los retos es el siguiente:</span><br/><br/><span class="hl-2">````</span><span class="hl-0">typescript</span><span class="hl-1">	</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">{</span><span class="hl-1"> </span><span class="hl-2">Schema,</span><span class="hl-1"> </span><span class="hl-2">Document,</span><span class="hl-1"> </span><span class="hl-2">model</span><span class="hl-1"> </span><span class="hl-2">}</span><span class="hl-1"> </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-2">&#39;mongoose&#39;</span><br/><span class="hl-0">/*</span><br/><span class="hl-0">ID</span><span class="hl-1"> </span><span class="hl-2">único</span><span class="hl-1"> </span><span class="hl-2">del</span><span class="hl-1"> </span><span class="hl-2">reto.</span><br/><span class="hl-0">Nombre</span><span class="hl-1"> </span><span class="hl-2">del</span><span class="hl-1"> </span><span class="hl-2">reto.</span><br/><span class="hl-0">Rutas</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">forman</span><span class="hl-1"> </span><span class="hl-2">parte</span><span class="hl-1"> </span><span class="hl-2">del</span><span class="hl-1"> </span><span class="hl-2">reto.</span><br/><span class="hl-0">Tipo</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">actividad</span><span class="hl-1"> </span><span class="hl-2">del</span><span class="hl-1"> </span><span class="hl-2">reto:</span><span class="hl-1"> </span><span class="hl-2">bicicleta</span><span class="hl-1"> </span><span class="hl-2">o</span><span class="hl-1"> </span><span class="hl-2">correr.</span><br/><span class="hl-0">Km</span><span class="hl-1"> </span><span class="hl-2">totales</span><span class="hl-1"> </span><span class="hl-2">a</span><span class="hl-1"> </span><span class="hl-2">realizar</span><span class="hl-1"> (como </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">suma</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">kms</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">las</span><span class="hl-1"> </span><span class="hl-2">rutas</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">lo</span><span class="hl-1"> </span><span class="hl-2">engloban</span><span class="hl-1">).</span><br/><span class="hl-0">Usuarios</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">están</span><span class="hl-1"> </span><span class="hl-2">realizando</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">reto.</span><br/><span class="hl-1">*/</span><br/><span class="hl-0">interface</span><span class="hl-1"> </span><span class="hl-2">challengeDocumentInterface</span><span class="hl-1"> </span><span class="hl-2">extends</span><span class="hl-1"> </span><span class="hl-2">Document</span><span class="hl-1"> </span><span class="hl-2">{</span><br/><span class="hl-1">    </span><span class="hl-0">id:</span><span class="hl-1"> </span><span class="hl-2">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">name:</span><span class="hl-1"> </span><span class="hl-2">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">tracks:</span><span class="hl-1"> </span><span class="hl-2">{</span><span class="hl-1"> </span><span class="hl-2">_id:</span><span class="hl-1"> </span><span class="hl-2">Schema.Types.ObjectId</span><span class="hl-1"> </span><span class="hl-2">}[]</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">activity:</span><span class="hl-1"> </span><span class="hl-2">&quot;Correr&quot;</span><span class="hl-1"> | </span><span class="hl-0">&quot;Bicicleta&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">//totalKm:</span><span class="hl-1"> </span><span class="hl-2">number</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">users:</span><span class="hl-1"> </span><span class="hl-2">{</span><span class="hl-1"> </span><span class="hl-2">_id:</span><span class="hl-1"> </span><span class="hl-2">Schema.Types.ObjectId</span><span class="hl-1"> </span><span class="hl-2">}[]</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">challengeSchema</span><span class="hl-1"> </span><span class="hl-2">=</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-2">Schema</span><span class="hl-1">&lt;</span><span class="hl-2">challengeDocumentInterfac</span><span class="hl-1">e</span><span class="hl-2">&gt;({</span><br/><span class="hl-2">    </span><span class="hl-0">id:</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: String,</span><br/><span class="hl-2">        </span><span class="hl-0">required:</span><span class="hl-2"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-2">        </span><span class="hl-0">unique:</span><span class="hl-2"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-0">name:</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: String,</span><br/><span class="hl-2">        </span><span class="hl-0">required:</span><span class="hl-2"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-0">tracks:</span><span class="hl-2"> [{</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: Schema.Types.ObjectId,</span><br/><span class="hl-2">        </span><span class="hl-0">ref:</span><span class="hl-2"> &quot;tracks&quot;,</span><br/><span class="hl-2">    }],</span><br/><span class="hl-2">    </span><span class="hl-0">activity:</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: String,</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-0">users:</span><span class="hl-2"> [{</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: Schema.Types.ObjectId,</span><br/><span class="hl-2">        </span><span class="hl-0">ref:</span><span class="hl-2"> &quot;users&quot;,</span><br/><span class="hl-2">    }],</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-4">export</span><span class="hl-2"> const challengeModel = model</span><span class="hl-1">&lt;</span><span class="hl-2">challengeDocumentInterface&gt;(</span><span class="hl-0">&#39;challenges&#39;,</span><span class="hl-2"> challengeSchema);</span><br/><span class="hl-2">````	</span><br/><br/><span class="hl-0">Primero,</span><span class="hl-2"> se importan las dependencias necesarias para definir el modelo: Schema, Document y model de la biblioteca Mongoose. Luego se define la interfaz challengeDocumentInterface que define los campos que compondrán el documento del reto.</span><br/><br/><span class="hl-0">El</span><span class="hl-2"> modelo challengeSchema se crea utilizando la interfaz definida anteriormente, especificando los campos de cada propiedad que compondrá el esquema de la base de datos. La propiedad id es del tipo String, es obligatoria y única. La propiedad name es del tipo String y también es obligatoria. La propiedad tracks es una matriz de objetos Schema.Types.ObjectId que representan los identificadores de los documentos de la colección tracks. La propiedad activity es una cadena que representa el tipo de actividad que se debe realizar, que puede ser &quot;Correr&quot; o &quot;Bicicleta&quot;. Por último, la propiedad users es una matriz de objetos Schema.Types.ObjectId que representan los identificadores de los documentos de la colección users.</span><br/><br/><span class="hl-0">Finalmente,</span><span class="hl-2"> se exporta el modelo challengeModel para que pueda ser utilizado en otras partes de la aplicación.</span><br/><br/><span class="hl-3">#### GroupSchema.ts &lt;a name=&quot;groupSchema&quot;&gt;&lt;/a&gt;</span><br/><br/><span class="hl-1">&gt;</span><span class="hl-2"> El modelo de datos para los grupos es el siguiente:</span><br/><br/><span class="hl-2">````</span><span class="hl-0">typescript</span><span class="hl-2">	</span><br/><span class="hl-0">import</span><span class="hl-2"> { Schema, Document, model } from &#39;mongoose&#39;</span><br/><span class="hl-0">import</span><span class="hl-2"> validator from &#39;validator&#39;</span><br/><span class="hl-0">/*</span><br/><span class="hl-0">ID</span><span class="hl-2"> único del grupo.</span><br/><span class="hl-0">Nombre</span><span class="hl-2"> del grupo.</span><br/><span class="hl-0">Participantes:</span><span class="hl-2"> IDs de los miembros del grupo.</span><br/><span class="hl-0">Estadísticas</span><span class="hl-2"> de entrenamiento grupal: Cantidad de km y desnivel total acumulados de manera grupal en la semana, mes y año</span><br/><span class="hl-0">Clasificación</span><span class="hl-2"> de los usuarios: Ranking de los usuarios que más entrenamientos han realizado históricamente dentro del grupo, es decir, ordenar los usuarios por la cantidad de km totales o desnivel total que han acumulado.</span><br/><span class="hl-0">Rutas</span><span class="hl-2"> favoritas del grupo: Rutas que los usuarios del grupo han realizado con mayor frecuencia en sus salidas conjuntas.</span><br/><span class="hl-0">Histórico</span><span class="hl-2"> de rutas realizadas por el grupo: Información similar que almacenan los usuarios pero en este caso referente a los grupos. Nótese que un usuario puede realizar rutas con un grupo y/o de manera individual el mismo día. Es decir, a modo de simplificación, asumimos que todos los usuarios de un grupo realizan la actividad cuando se planifica. Aunque, también pueden realizar otras actividades de manera individual.</span><span class="hl-4">*</span><span class="hl-2">/</span><br/><br/><span class="hl-0">interface</span><span class="hl-2"> groupDocumentInterface extends Document {</span><br/><span class="hl-2">    </span><span class="hl-0">id:</span><span class="hl-2"> string;</span><br/><span class="hl-2">    </span><span class="hl-0">name:</span><span class="hl-2"> string;</span><br/><span class="hl-2">    </span><span class="hl-0">participants:</span><span class="hl-2"> { _id: Schema.Types.ObjectId }[];</span><br/><span class="hl-2">    </span><span class="hl-0">//stats:</span><span class="hl-2"> string[];</span><br/><span class="hl-2">    </span><span class="hl-0">//ranking:</span><span class="hl-2"> string[];</span><br/><span class="hl-2">    </span><span class="hl-0">//favoriteRoutes:</span><span class="hl-2"> string[];</span><br/><span class="hl-2">    </span><span class="hl-0">historicTracks:</span><span class="hl-2"> {date: Date, _id: Schema.Types.ObjectId }[];</span><br/><span class="hl-2">  }</span><br/><br/><span class="hl-0">const</span><span class="hl-2"> groupSchema = new Schema</span><span class="hl-1">&lt;</span><span class="hl-2">groupDocumentInterface&gt;({</span><br/><span class="hl-2">    </span><span class="hl-0">id:</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: String,</span><br/><span class="hl-2">        </span><span class="hl-0">required:</span><span class="hl-2"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-2">        </span><span class="hl-0">unique:</span><span class="hl-2"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-0">name:</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: String,</span><br/><span class="hl-2">        </span><span class="hl-0">required:</span><span class="hl-2"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-0">participants:</span><span class="hl-2"> [{</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: Schema.Types.ObjectId,</span><br/><span class="hl-2">        </span><span class="hl-0">ref:</span><span class="hl-2"> &quot;users&quot;,</span><br/><span class="hl-2">    }],</span><br/><span class="hl-2">    </span><span class="hl-0">historicTracks:</span><span class="hl-2"> [{</span><br/><span class="hl-2">        </span><span class="hl-0">date:</span><span class="hl-2"> {</span><br/><span class="hl-2">            </span><span class="hl-0">type</span><span class="hl-2">: Date,</span><br/><span class="hl-2">        },</span><br/><span class="hl-2">        </span><span class="hl-0">track:</span><span class="hl-2"> {</span><br/><span class="hl-2">            </span><span class="hl-0">type</span><span class="hl-2">: Schema.Types.ObjectId,</span><br/><span class="hl-2">            </span><span class="hl-0">ref:</span><span class="hl-2"> &quot;tracks&quot;,</span><br/><span class="hl-2">        }</span><br/><span class="hl-2">    }],</span><br/><span class="hl-2">});</span><br/><br/><span class="hl-4">export</span><span class="hl-2"> const groupModel = model</span><span class="hl-1">&lt;</span><span class="hl-2">groupDocumentInterface&gt;(</span><span class="hl-0">&#39;groups&#39;,</span><span class="hl-2"> groupSchema);</span><br/><span class="hl-2">````	</span><br/><br/><span class="hl-0">Primero,</span><span class="hl-2"> se importan los elementos necesarios de Mongoose, incluyendo el tipo de esquema, el tipo de documento y el modelo.</span><br/><br/><span class="hl-0">Luego,</span><span class="hl-2"> se define una interfaz groupDocumentInterface que define la forma de los documentos que se almacenarán en la colección &quot;groups&quot; de la base de datos. Esta interfaz describe los campos que se almacenarán en cada documento, incluyendo:</span><br/><br/><span class="hl-0">-</span><span class="hl-2"> id: un identificador único para el grupo</span><br/><span class="hl-0">-</span><span class="hl-2"> name: el nombre del grupo</span><br/><span class="hl-0">-</span><span class="hl-2"> participants: una lista de IDs de los miembros del grupo</span><br/><span class="hl-0">-</span><span class="hl-2"> historicTracks: una lista de las rutas realizadas por el grupo, junto con las fechas en que se realizaron.</span><br/><br/><span class="hl-0">A</span><span class="hl-2"> continuación, se define un esquema groupSchema utilizando la interfaz definida anteriormente. El esquema especifica los tipos y las restricciones de los campos definidos en la interfaz. En este caso, el campo &quot;id&quot; es obligatorio, único y debe ser una cadena de caracteres. El campo &quot;name&quot; es obligatorio y también debe ser una cadena de caracteres. El campo &quot;participants&quot; es una matriz de ObjectIds que se refieren a documentos de usuarios en la colección &quot;users&quot; de la base de datos. El campo &quot;historicTracks&quot; es una matriz de objetos que contienen una fecha y una referencia a un documento de ruta en la colección &quot;tracks&quot; de la base de datos.</span><br/><br/><span class="hl-0">Finalmente,</span><span class="hl-2"> se exporta el modelo de grupo utilizando el esquema definido y el método model() de Mongoose. El modelo se guarda en la variable groupModel.</span><br/><br/><span class="hl-3">#### TrackSchema.ts &lt;a name=&quot;trackSchema&quot;&gt;&lt;/a&gt;</span><br/><br/><span class="hl-1">&gt;</span><span class="hl-2"> El modelo de datos para las rutas es el siguiente:</span><br/><br/><span class="hl-2">````</span><span class="hl-0">typescript</span><span class="hl-2">	</span><br/><span class="hl-0">import</span><span class="hl-2"> { Schema, Document, model } from &#39;mongoose&#39;</span><br/><br/><span class="hl-0">interface</span><span class="hl-2"> trackDocumentInterface extends Document {</span><br/><span class="hl-2">    </span><span class="hl-0">id:</span><span class="hl-2"> string;</span><br/><span class="hl-2">    </span><span class="hl-0">name:</span><span class="hl-2"> string;</span><br/><span class="hl-2">    </span><span class="hl-0">startCoords:</span><span class="hl-2"> string;</span><br/><span class="hl-2">    </span><span class="hl-0">endCoords:</span><span class="hl-2"> string;</span><br/><span class="hl-2">    </span><span class="hl-0">long:</span><span class="hl-2"> number;</span><br/><span class="hl-2">    </span><span class="hl-0">unevenness:</span><span class="hl-2"> number;</span><br/><span class="hl-2">    </span><span class="hl-0">activities:</span><span class="hl-2"> &quot;Correr&quot; </span><span class="hl-1">|</span><span class="hl-2"> </span><span class="hl-0">&quot;Bicicleta&quot;</span><span class="hl-2">;</span><br/><span class="hl-2">    </span><span class="hl-0">finalized:</span><span class="hl-2"> { _id: Schema.Types.ObjectId }[];</span><br/><span class="hl-2">    </span><span class="hl-0">calification:</span><span class="hl-2"> number;</span><br/><span class="hl-2">    </span><br/><span class="hl-2">}</span><br/><br/><span class="hl-0">const</span><span class="hl-2"> trackSchema = new Schema</span><span class="hl-1">&lt;</span><span class="hl-2">trackDocumentInterface&gt;({</span><br/><span class="hl-2">    </span><span class="hl-0">id:</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: String,</span><br/><span class="hl-2">        </span><span class="hl-0">required:</span><span class="hl-2"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-2">        </span><span class="hl-0">unique:</span><span class="hl-2"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-0">name:</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: String,</span><br/><span class="hl-2">        </span><span class="hl-0">required:</span><span class="hl-2"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-0">startCoords:</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: String,</span><br/><span class="hl-2">        </span><span class="hl-0">required:</span><span class="hl-2"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-0">endCoords:</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: String,</span><br/><span class="hl-2">        </span><span class="hl-0">required:</span><span class="hl-2"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-0">long:</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: Number,</span><br/><span class="hl-2">        </span><span class="hl-0">required:</span><span class="hl-2"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-0">unevenness:</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: Number,</span><br/><span class="hl-2">        </span><span class="hl-0">required:</span><span class="hl-2"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-0">activities:</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: String,</span><br/><span class="hl-2">        </span><span class="hl-0">required:</span><span class="hl-2"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-0">finalized:</span><span class="hl-2"> [{</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: Schema.Types.ObjectId,</span><br/><span class="hl-2">        </span><span class="hl-0">ref:</span><span class="hl-2"> &quot;users&quot;</span><br/><span class="hl-2">    }],</span><br/><span class="hl-2">    </span><span class="hl-0">calification:</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: Number,</span><br/><span class="hl-2">        </span><span class="hl-0">required:</span><span class="hl-2"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-2">    }</span><br/><span class="hl-2">  });</span><br/><br/><span class="hl-2">  </span><span class="hl-4">export</span><span class="hl-2"> const trackModel = model</span><span class="hl-1">&lt;</span><span class="hl-2">trackDocumentInterface&gt;(</span><span class="hl-0">&#39;tracks&#39;,</span><span class="hl-2"> trackSchema);</span><br/><span class="hl-2">````	</span><br/><br/><span class="hl-0">El</span><span class="hl-2"> modelo de datos se define como una interfaz TypeScript trackDocumentInterface, que extiende la interfaz Document de Mongoose y define las propiedades que tendrán los documentos de esta colección en la base de datos.</span><br/><br/><span class="hl-0">Las</span><span class="hl-2"> propiedades incluyen:</span><br/><br/><span class="hl-0">-</span><span class="hl-2"> id: un campo de tipo String que es requerido y debe ser único.</span><br/><span class="hl-0">-</span><span class="hl-2"> name: un campo de tipo String que es requerido y define el nombre de la ruta.</span><br/><span class="hl-0">-</span><span class="hl-2"> startCoords y endCoords: campos de tipo String que representan las coordenadas de inicio y finalización de la ruta y son requeridos.</span><br/><span class="hl-0">-</span><span class="hl-2"> long: un campo de tipo Number que es requerido y define la longitud de la ruta en kilómetros.</span><br/><span class="hl-0">-</span><span class="hl-2"> unevenness: un campo de tipo Number que es requerido y define la cantidad de desnivel acumulado en metros a lo largo de la ruta.</span><br/><span class="hl-0">-</span><span class="hl-2"> activities: un campo de tipo String que es requerido y define el tipo de actividad que se puede realizar en la ruta, que puede ser &quot;Correr&quot; o &quot;Bicicleta&quot;.</span><br/><span class="hl-0">-</span><span class="hl-2"> finalized: un arreglo de objetos de tipo Schema.Types.ObjectId que se refieren a usuarios que han finalizado esta ruta.</span><br/><span class="hl-0">-</span><span class="hl-2"> calification: un campo de tipo Number que es requerido y representa la calificación promedio que ha recibido esta ruta de los usuarios que la han finalizado.</span><br/><br/><span class="hl-0">El</span><span class="hl-2"> esquema (trackSchema) se crea a partir de la interfaz trackDocumentInterface y se usa para definir el modelo de datos en la base de datos MongoDB a través de Mongoose. Finalmente, se exporta este modelo de datos utilizando model</span><span class="hl-1">&lt;</span><span class="hl-2">trackDocumentInterface&gt;(</span><span class="hl-0">&#39;tracks&#39;,</span><span class="hl-2"> trackSchema) para que pueda ser utilizado en la aplicación.</span><br/><br/><span class="hl-3">#### UserSchema.ts &lt;a name=&quot;userSchema&quot;&gt;&lt;/a&gt;</span><br/><br/><span class="hl-1">&gt;</span><span class="hl-2"> El modelo de datos para los usuarios es el siguiente:</span><br/><br/><span class="hl-2">````</span><span class="hl-0">typescript</span><span class="hl-2">	</span><br/><span class="hl-0">import</span><span class="hl-2"> { Schema, Document, model } from &#39;mongoose&#39;</span><br/><span class="hl-0">/*</span><br/><span class="hl-0">ID</span><span class="hl-2"> único del usuario (puede ser un username creado por el usuario en el registro o un valor generado automáticamente por el sistema).</span><br/><span class="hl-0">Nombre</span><span class="hl-1"> </span><span class="hl-2">del</span><span class="hl-1"> </span><span class="hl-2">usuario.</span><br/><span class="hl-0">Actividades</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">realiza:</span><span class="hl-1"> </span><span class="hl-2">Correr</span><span class="hl-1"> </span><span class="hl-2">o</span><span class="hl-1"> </span><span class="hl-2">bicicleta.</span><br/><span class="hl-0">Amigos</span><span class="hl-1"> </span><span class="hl-2">en</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">aplicación:</span><span class="hl-1"> </span><span class="hl-2">Colleción</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">IDs</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">usuarios</span><span class="hl-1"> </span><span class="hl-2">con</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">interacciona.</span><br/><span class="hl-0">Grupos</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">amigos:</span><span class="hl-1"> </span><span class="hl-2">Diferentes</span><span class="hl-1"> </span><span class="hl-2">colecciones</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">IDs</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">usuarios</span><span class="hl-1"> </span><span class="hl-2">con</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">suele</span><span class="hl-1"> </span><span class="hl-2">realizar</span><span class="hl-1"> </span><span class="hl-2">rutas.</span><br/><span class="hl-0">Estadísticas</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">entrenamiento:</span><span class="hl-1"> </span><span class="hl-2">Cantidad</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">km</span><span class="hl-1"> </span><span class="hl-2">y</span><span class="hl-1"> </span><span class="hl-2">desnivel</span><span class="hl-1"> </span><span class="hl-2">total</span><span class="hl-1"> </span><span class="hl-2">acumulados</span><span class="hl-1"> </span><span class="hl-2">en</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">semana,</span><span class="hl-1"> </span><span class="hl-2">mes</span><span class="hl-1"> </span><span class="hl-2">y</span><span class="hl-1"> </span><span class="hl-2">año.</span><br/><span class="hl-0">Rutas</span><span class="hl-1"> </span><span class="hl-2">favoritas:</span><span class="hl-1"> </span><span class="hl-2">IDs</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">las</span><span class="hl-1"> </span><span class="hl-2">rutas</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">usuario</span><span class="hl-1"> </span><span class="hl-2">ha</span><span class="hl-1"> </span><span class="hl-2">realizado</span><span class="hl-1"> </span><span class="hl-2">con</span><span class="hl-1"> </span><span class="hl-2">mayor</span><span class="hl-1"> </span><span class="hl-2">frecuencia.</span><br/><span class="hl-0">Retos</span><span class="hl-1"> </span><span class="hl-2">activos:</span><span class="hl-1"> </span><span class="hl-2">IDs</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">retos</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">usuario</span><span class="hl-1"> </span><span class="hl-2">está</span><span class="hl-1"> </span><span class="hl-2">realizando</span><span class="hl-1"> </span><span class="hl-2">actualmente.</span><br/><span class="hl-0">Histórico</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">rutas:</span><span class="hl-1"> </span><span class="hl-2">Los</span><span class="hl-1"> </span><span class="hl-2">usuarios</span><span class="hl-1"> </span><span class="hl-2">deben</span><span class="hl-1"> </span><span class="hl-2">almacenar</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">historial</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">rutas</span><span class="hl-1"> </span><span class="hl-2">realizadas</span><span class="hl-1"> </span><span class="hl-2">desde</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">registraron</span><span class="hl-1"> </span><span class="hl-2">en</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">sistema.</span><span class="hl-1"> </span><span class="hl-2">La</span><span class="hl-1"> </span><span class="hl-2">información</span><span class="hl-1"> </span><span class="hl-2">almacenada</span><span class="hl-1"> </span><span class="hl-2">en</span><span class="hl-1"> </span><span class="hl-2">esta</span><span class="hl-1"> </span><span class="hl-2">estructura</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">datos</span><span class="hl-1"> </span><span class="hl-2">deberá</span><span class="hl-1"> </span><span class="hl-2">contener</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">información</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">fecha</span><span class="hl-1"> </span><span class="hl-2">y</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">ID</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">ruta</span><span class="hl-1"> </span><span class="hl-2">realizada.</span><span class="hl-1"> </span><span class="hl-2">Nótese</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">un</span><span class="hl-1"> </span><span class="hl-2">usuario</span><span class="hl-1"> </span><span class="hl-2">puede</span><span class="hl-1"> </span><span class="hl-2">realizar</span><span class="hl-1"> </span><span class="hl-2">más</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">una</span><span class="hl-1"> </span><span class="hl-2">ruta</span><span class="hl-1"> </span><span class="hl-2">al</span><span class="hl-1"> </span><span class="hl-2">día</span><span class="hl-1"> </span><span class="hl-2">y</span><span class="hl-1"> </span><span class="hl-2">está</span><span class="hl-1"> </span><span class="hl-2">decisión</span><span class="hl-1"> </span><span class="hl-2">puede</span><span class="hl-1"> </span><span class="hl-2">afectar</span><span class="hl-1"> </span><span class="hl-2">al</span><span class="hl-1"> </span><span class="hl-2">tipo</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">estructura</span><span class="hl-1"> </span><span class="hl-2">en</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">almacena</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">información.</span><br/><span class="hl-1">*/</span><br/><br/><span class="hl-0">interface</span><span class="hl-1"> </span><span class="hl-2">userDocumentInterface</span><span class="hl-1"> </span><span class="hl-2">extends</span><span class="hl-1"> </span><span class="hl-2">Document</span><span class="hl-1"> </span><span class="hl-2">{</span><br/><span class="hl-1">    </span><span class="hl-0">id:</span><span class="hl-1"> </span><span class="hl-2">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">name:</span><span class="hl-1"> </span><span class="hl-2">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">activities:</span><span class="hl-1"> </span><span class="hl-2">&quot;Correr&quot;</span><span class="hl-1"> | </span><span class="hl-0">&quot;Bicicleta&quot;</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">friends:</span><span class="hl-1"> </span><span class="hl-2">{</span><span class="hl-1"> </span><span class="hl-2">_id:</span><span class="hl-1"> </span><span class="hl-2">Schema.Types.ObjectId</span><span class="hl-1"> </span><span class="hl-2">}[]</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">groups:</span><span class="hl-1"> </span><span class="hl-2">{</span><span class="hl-1"> </span><span class="hl-2">_id:</span><span class="hl-1"> </span><span class="hl-2">Schema.Types.ObjectId</span><span class="hl-1"> </span><span class="hl-2">}[]</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">//stats:</span><span class="hl-1"> </span><span class="hl-2">string[]</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">//favoriteRoutes:</span><span class="hl-1"> </span><span class="hl-2">string[]</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">//activeChallenges:</span><span class="hl-1"> </span><span class="hl-2">string[]</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-0">historicTracks:</span><span class="hl-1"> </span><span class="hl-2">{date:</span><span class="hl-1"> </span><span class="hl-2">Date,</span><span class="hl-1"> </span><span class="hl-2">_id:</span><span class="hl-1"> </span><span class="hl-2">Schema.Types.ObjectId</span><span class="hl-1"> </span><span class="hl-2">}[]</span><span class="hl-1">;</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">userSchema</span><span class="hl-1"> </span><span class="hl-2">=</span><span class="hl-1"> </span><span class="hl-2">new</span><span class="hl-1"> </span><span class="hl-2">Schema</span><span class="hl-1">&lt;</span><span class="hl-2">userDocumentInterfac</span><span class="hl-1">e</span><span class="hl-2">&gt;({</span><br/><span class="hl-2">    </span><span class="hl-0">id:</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: String,</span><br/><span class="hl-2">        </span><span class="hl-0">required:</span><span class="hl-2"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-2">        </span><span class="hl-0">unique:</span><span class="hl-2"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-0">name:</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: String,</span><br/><span class="hl-2">        </span><span class="hl-0">required:</span><span class="hl-2"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-0">activities:</span><span class="hl-2"> {</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: String,</span><br/><span class="hl-2">        </span><span class="hl-0">required:</span><span class="hl-2"> </span><span class="hl-4">true</span><span class="hl-2">,</span><br/><span class="hl-2">    },</span><br/><span class="hl-2">    </span><span class="hl-0">friends:</span><span class="hl-2"> [{</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: Schema.Types.ObjectId,</span><br/><span class="hl-2">        </span><span class="hl-0">ref:</span><span class="hl-2"> &quot;users&quot;</span><br/><span class="hl-2">    }],</span><br/><span class="hl-2">    </span><span class="hl-0">groups:</span><span class="hl-2"> [{</span><br/><span class="hl-2">        </span><span class="hl-0">type</span><span class="hl-2">: Schema.Types.ObjectId,</span><br/><span class="hl-2">        </span><span class="hl-0">ref:</span><span class="hl-2"> &quot;groups&quot;</span><br/><span class="hl-2">    }],</span><br/><span class="hl-2">    </span><span class="hl-0">historicTracks:</span><span class="hl-2"> [{</span><br/><span class="hl-2">        </span><span class="hl-0">date:</span><span class="hl-2"> {</span><br/><span class="hl-2">            </span><span class="hl-0">type</span><span class="hl-2">: Date,</span><br/><span class="hl-2">        },</span><br/><span class="hl-2">        </span><span class="hl-0">track:</span><span class="hl-2"> {</span><br/><span class="hl-2">            </span><span class="hl-0">type</span><span class="hl-2">: Schema.Types.ObjectId,</span><br/><span class="hl-2">            </span><span class="hl-0">ref:</span><span class="hl-2"> &quot;tracks&quot;,</span><br/><span class="hl-2">        }</span><br/><span class="hl-2">    }]</span><br/><span class="hl-2">  })</span><span class="hl-1">;</span><br/><br/><span class="hl-1">  </span><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-2">const</span><span class="hl-1"> </span><span class="hl-2">userModel</span><span class="hl-1"> </span><span class="hl-2">=</span><span class="hl-1"> </span><span class="hl-2">model</span><span class="hl-1">&lt;</span><span class="hl-2">userDocumentInterfac</span><span class="hl-1">e</span><span class="hl-2">&gt;(</span><span class="hl-0">&#39;users&#39;,</span><span class="hl-2"> userSchema)</span><span class="hl-1">;</span><br/><span class="hl-2">````</span><span class="hl-1">	</span><br/><br/><span class="hl-0">En</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">primera</span><span class="hl-1"> </span><span class="hl-2">sección</span><span class="hl-1"> </span><span class="hl-2">del</span><span class="hl-1"> </span><span class="hl-2">código,</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">importan</span><span class="hl-1"> </span><span class="hl-2">las</span><span class="hl-1"> </span><span class="hl-2">clases</span><span class="hl-1"> </span><span class="hl-2">Schema,</span><span class="hl-1"> </span><span class="hl-2">Document</span><span class="hl-1"> </span><span class="hl-2">y</span><span class="hl-1"> </span><span class="hl-2">model</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">Mongoose.</span><br/><br/><span class="hl-0">A</span><span class="hl-1"> </span><span class="hl-2">continuación,</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">define</span><span class="hl-1"> </span><span class="hl-2">una</span><span class="hl-1"> </span><span class="hl-2">interfaz</span><span class="hl-1"> </span><span class="hl-2">llamada</span><span class="hl-1"> </span><span class="hl-2">userDocumentInterface</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">extiende</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">Document.</span><span class="hl-1"> </span><span class="hl-2">Esta</span><span class="hl-1"> </span><span class="hl-2">interfaz</span><span class="hl-1"> </span><span class="hl-2">define</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">campos</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">utilizarán</span><span class="hl-1"> </span><span class="hl-2">para</span><span class="hl-1"> </span><span class="hl-2">crear</span><span class="hl-1"> </span><span class="hl-2">y</span><span class="hl-1"> </span><span class="hl-2">manipular</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">objetos</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">usuario.</span><span class="hl-1"> </span><span class="hl-2">Los</span><span class="hl-1"> </span><span class="hl-2">campos</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">incluyen</span><span class="hl-1"> </span><span class="hl-2">son:</span><br/><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">id:</span><span class="hl-1"> </span><span class="hl-2">Es</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">ID</span><span class="hl-1"> </span><span class="hl-2">único</span><span class="hl-1"> </span><span class="hl-2">del</span><span class="hl-1"> </span><span class="hl-2">usuario.</span><span class="hl-1"> </span><span class="hl-2">Puede</span><span class="hl-1"> </span><span class="hl-2">ser</span><span class="hl-1"> </span><span class="hl-2">un</span><span class="hl-1"> </span><span class="hl-2">valor</span><span class="hl-1"> </span><span class="hl-2">generado</span><span class="hl-1"> </span><span class="hl-2">automáticamente</span><span class="hl-1"> </span><span class="hl-2">por</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">sistema</span><span class="hl-1"> </span><span class="hl-2">o</span><span class="hl-1"> </span><span class="hl-2">un</span><span class="hl-1"> </span><span class="hl-2">nombre</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">usuario</span><span class="hl-1"> </span><span class="hl-2">creado</span><span class="hl-1"> </span><span class="hl-2">por</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">usuario</span><span class="hl-1"> </span><span class="hl-2">durante</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">registro.</span><span class="hl-1"> </span><span class="hl-2">Se</span><span class="hl-1"> </span><span class="hl-2">define</span><span class="hl-1"> </span><span class="hl-2">como</span><span class="hl-1"> </span><span class="hl-2">una</span><span class="hl-1"> </span><span class="hl-2">cadena</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">caracteres</span><span class="hl-1"> (string) y es obligatorio (</span><span class="hl-0">required:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">) y único (</span><span class="hl-0">unique:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">).</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">name:</span><span class="hl-1"> </span><span class="hl-2">Es</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">nombre</span><span class="hl-1"> </span><span class="hl-2">del</span><span class="hl-1"> </span><span class="hl-2">usuario.</span><span class="hl-1"> </span><span class="hl-2">Se</span><span class="hl-1"> </span><span class="hl-2">define</span><span class="hl-1"> </span><span class="hl-2">como</span><span class="hl-1"> </span><span class="hl-2">una</span><span class="hl-1"> </span><span class="hl-2">cadena</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">caracteres</span><span class="hl-1"> </span><span class="hl-2">y</span><span class="hl-1"> </span><span class="hl-2">es</span><span class="hl-1"> </span><span class="hl-2">obligatorio.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">activities:</span><span class="hl-1"> </span><span class="hl-2">Es</span><span class="hl-1"> </span><span class="hl-2">una</span><span class="hl-1"> </span><span class="hl-2">cadena</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">representa</span><span class="hl-1"> </span><span class="hl-2">las</span><span class="hl-1"> </span><span class="hl-2">actividades</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">realiza</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">usuario.</span><span class="hl-1"> </span><span class="hl-2">En</span><span class="hl-1"> </span><span class="hl-2">este</span><span class="hl-1"> </span><span class="hl-2">caso,</span><span class="hl-1"> </span><span class="hl-2">puede</span><span class="hl-1"> </span><span class="hl-2">ser</span><span class="hl-1"> </span><span class="hl-2">&quot;Correr&quot;</span><span class="hl-1"> </span><span class="hl-2">o</span><span class="hl-1"> </span><span class="hl-2">&quot;Bicicleta&quot;.</span><span class="hl-1"> </span><span class="hl-2">Se</span><span class="hl-1"> </span><span class="hl-2">define</span><span class="hl-1"> </span><span class="hl-2">como</span><span class="hl-1"> </span><span class="hl-2">una</span><span class="hl-1"> </span><span class="hl-2">cadena</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">caracteres</span><span class="hl-1"> </span><span class="hl-2">y</span><span class="hl-1"> </span><span class="hl-2">es</span><span class="hl-1"> </span><span class="hl-2">obligatorio.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">friends:</span><span class="hl-1"> </span><span class="hl-2">Es</span><span class="hl-1"> </span><span class="hl-2">una</span><span class="hl-1"> </span><span class="hl-2">colección</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">objetos</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">representan</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">IDs</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">amigos</span><span class="hl-1"> </span><span class="hl-2">del</span><span class="hl-1"> </span><span class="hl-2">usuario.</span><span class="hl-1"> </span><span class="hl-2">Se</span><span class="hl-1"> </span><span class="hl-2">define</span><span class="hl-1"> </span><span class="hl-2">como</span><span class="hl-1"> </span><span class="hl-2">un</span><span class="hl-1"> </span><span class="hl-2">arreglo</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">objetos</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">contienen</span><span class="hl-1"> </span><span class="hl-2">una</span><span class="hl-1"> </span><span class="hl-2">propiedad</span><span class="hl-1"> </span><span class="hl-2">_id</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">tipo</span><span class="hl-1"> </span><span class="hl-2">Schema.Types.ObjectId.</span><span class="hl-1"> </span><span class="hl-2">Cada</span><span class="hl-1"> </span><span class="hl-2">uno</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">estos</span><span class="hl-1"> </span><span class="hl-2">IDs</span><span class="hl-1"> </span><span class="hl-2">debe</span><span class="hl-1"> </span><span class="hl-2">hacer</span><span class="hl-1"> </span><span class="hl-2">referencia</span><span class="hl-1"> </span><span class="hl-2">a</span><span class="hl-1"> </span><span class="hl-2">un</span><span class="hl-1"> </span><span class="hl-2">objeto</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">usuario</span><span class="hl-1"> </span><span class="hl-2">existente</span><span class="hl-1"> </span><span class="hl-2">en</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">base</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">datos.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">groups:</span><span class="hl-1"> </span><span class="hl-2">Es</span><span class="hl-1"> </span><span class="hl-2">una</span><span class="hl-1"> </span><span class="hl-2">colección</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">objetos</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">representan</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">IDs</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">grupos</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">amigos</span><span class="hl-1"> </span><span class="hl-2">del</span><span class="hl-1"> </span><span class="hl-2">usuario.</span><span class="hl-1"> </span><span class="hl-2">Se</span><span class="hl-1"> </span><span class="hl-2">define</span><span class="hl-1"> </span><span class="hl-2">como</span><span class="hl-1"> </span><span class="hl-2">un</span><span class="hl-1"> </span><span class="hl-2">arreglo</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">objetos</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">contienen</span><span class="hl-1"> </span><span class="hl-2">una</span><span class="hl-1"> </span><span class="hl-2">propiedad</span><span class="hl-1"> </span><span class="hl-2">_id</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">tipo</span><span class="hl-1"> </span><span class="hl-2">Schema.Types.ObjectId.</span><span class="hl-1"> </span><span class="hl-2">Cada</span><span class="hl-1"> </span><span class="hl-2">uno</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">estos</span><span class="hl-1"> </span><span class="hl-2">IDs</span><span class="hl-1"> </span><span class="hl-2">debe</span><span class="hl-1"> </span><span class="hl-2">hacer</span><span class="hl-1"> </span><span class="hl-2">referencia</span><span class="hl-1"> </span><span class="hl-2">a</span><span class="hl-1"> </span><span class="hl-2">un</span><span class="hl-1"> </span><span class="hl-2">objeto</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">grupo</span><span class="hl-1"> </span><span class="hl-2">existente</span><span class="hl-1"> </span><span class="hl-2">en</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">base</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">datos.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">historicTracks:</span><span class="hl-1"> </span><span class="hl-2">Es</span><span class="hl-1"> </span><span class="hl-2">una</span><span class="hl-1"> </span><span class="hl-2">colección</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">objetos</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">representan</span><span class="hl-1"> </span><span class="hl-2">las</span><span class="hl-1"> </span><span class="hl-2">rutas</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">ha</span><span class="hl-1"> </span><span class="hl-2">realizado</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">usuario.</span><span class="hl-1"> </span><span class="hl-2">Se</span><span class="hl-1"> </span><span class="hl-2">define</span><span class="hl-1"> </span><span class="hl-2">como</span><span class="hl-1"> </span><span class="hl-2">un</span><span class="hl-1"> </span><span class="hl-2">arreglo</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">objetos</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">contienen</span><span class="hl-1"> </span><span class="hl-2">una</span><span class="hl-1"> </span><span class="hl-2">propiedad</span><span class="hl-1"> </span><span class="hl-2">date</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">tipo</span><span class="hl-1"> </span><span class="hl-2">Date,</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">representa</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">fecha</span><span class="hl-1"> </span><span class="hl-2">en</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">realizó</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">ruta,</span><span class="hl-1"> </span><span class="hl-2">y</span><span class="hl-1"> </span><span class="hl-2">una</span><span class="hl-1"> </span><span class="hl-2">propiedad</span><span class="hl-1"> </span><span class="hl-2">track</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">tipo</span><span class="hl-1"> </span><span class="hl-2">Schema.Types.ObjectId,</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">hace</span><span class="hl-1"> </span><span class="hl-2">referencia</span><span class="hl-1"> </span><span class="hl-2">a</span><span class="hl-1"> </span><span class="hl-2">un</span><span class="hl-1"> </span><span class="hl-2">objeto</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">ruta</span><span class="hl-1"> </span><span class="hl-2">existente</span><span class="hl-1"> </span><span class="hl-2">en</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">base</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">datos.</span><br/><br/><span class="hl-0">Después,</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">crea</span><span class="hl-1"> </span><span class="hl-2">un</span><span class="hl-1"> </span><span class="hl-2">nuevo</span><span class="hl-1"> </span><span class="hl-2">objeto</span><span class="hl-1"> </span><span class="hl-2">Schema</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">Mongoose</span><span class="hl-1"> </span><span class="hl-2">llamado</span><span class="hl-1"> </span><span class="hl-2">userSchema,</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">toma</span><span class="hl-1"> </span><span class="hl-2">como</span><span class="hl-1"> </span><span class="hl-2">parámetro</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">interfaz</span><span class="hl-1"> </span><span class="hl-2">userDocumentInterface.</span><span class="hl-1"> </span><span class="hl-2">En</span><span class="hl-1"> </span><span class="hl-2">este</span><span class="hl-1"> </span><span class="hl-2">objeto</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">definen</span><span class="hl-1"> </span><span class="hl-2">las</span><span class="hl-1"> </span><span class="hl-2">propiedades</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">cada</span><span class="hl-1"> </span><span class="hl-2">campo</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">van</span><span class="hl-1"> </span><span class="hl-2">a</span><span class="hl-1"> </span><span class="hl-2">utilizar</span><span class="hl-1"> </span><span class="hl-2">en</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">modelo</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">datos.</span><br/><br/><span class="hl-0">Finalmente,</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">exporta</span><span class="hl-1"> </span><span class="hl-2">un</span><span class="hl-1"> </span><span class="hl-2">modelo</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">datos</span><span class="hl-1"> </span><span class="hl-2">llamado</span><span class="hl-1"> </span><span class="hl-2">userModel</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">utiliza</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">esquema</span><span class="hl-1"> </span><span class="hl-2">userSchema</span><span class="hl-1"> </span><span class="hl-2">y</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">le</span><span class="hl-1"> </span><span class="hl-2">asigna</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">colección</span><span class="hl-1"> </span><span class="hl-2">&quot;users&quot;</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">base</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">datos.</span><span class="hl-1"> </span><span class="hl-2">Este</span><span class="hl-1"> </span><span class="hl-2">modelo</span><span class="hl-1"> </span><span class="hl-2">permitirá</span><span class="hl-1"> </span><span class="hl-2">crear,</span><span class="hl-1"> </span><span class="hl-2">leer,</span><span class="hl-1"> </span><span class="hl-2">actualizar</span><span class="hl-1"> </span><span class="hl-2">y</span><span class="hl-1"> </span><span class="hl-2">eliminar</span><span class="hl-1"> </span><span class="hl-2">objetos</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">usuario</span><span class="hl-1"> </span><span class="hl-2">en</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">base</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">datos</span><span class="hl-1"> </span><span class="hl-2">MongoDB</span><span class="hl-1"> </span><span class="hl-2">a</span><span class="hl-1"> </span><span class="hl-2">través</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">Node.js.</span><br/><br/><span class="hl-3">### Rutas &lt;a name=&quot;rutas&quot;&gt;&lt;/a&gt;</span><br/><span class="hl-1">&gt; [Volver al índice](#índice)</span><br/><br/><span class="hl-1">&gt; </span><span class="hl-0">En</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">carpeta</span><span class="hl-1"> </span><span class="hl-2">routes</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">encuentran</span><span class="hl-1"> </span><span class="hl-2">las</span><span class="hl-1"> </span><span class="hl-2">rutas</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">aplicación</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">son</span><span class="hl-1"> </span><span class="hl-2">aquellas</span><span class="hl-1"> </span><span class="hl-2">con</span><span class="hl-1"> </span><span class="hl-2">las</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">se</span><span class="hl-1"> </span><span class="hl-2">puede</span><span class="hl-1"> </span><span class="hl-2">interactuar</span><span class="hl-1"> </span><span class="hl-2">a</span><span class="hl-1"> </span><span class="hl-2">través</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">la</span><span class="hl-1"> </span><span class="hl-2">API</span><span class="hl-1"> </span><span class="hl-2">mediante</span><span class="hl-1"> </span><span class="hl-2">las</span><span class="hl-1"> </span><span class="hl-2">peticiones</span><span class="hl-1"> </span><span class="hl-2">que</span><span class="hl-1"> </span><span class="hl-2">hacemos</span><span class="hl-1"> </span><span class="hl-2">con</span><span class="hl-1"> </span><span class="hl-2">ThunderClient.</span><span class="hl-1"> </span><span class="hl-2">Las</span><span class="hl-1"> </span><span class="hl-2">rutas</span><span class="hl-1"> </span><span class="hl-2">son</span><span class="hl-1"> </span><span class="hl-2">las</span><span class="hl-1"> </span><span class="hl-2">siguientes:</span><br/><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">challengeRouter.ts:</span><span class="hl-1"> </span><span class="hl-2">rutas</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">retos.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">groupRouter.ts:</span><span class="hl-1"> </span><span class="hl-2">rutas</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">grupos.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">trackRouter.ts:</span><span class="hl-1"> </span><span class="hl-2">rutas</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">las</span><span class="hl-1"> </span><span class="hl-2">rutas.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">userRouter.ts:</span><span class="hl-1"> </span><span class="hl-2">rutas</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">usuarios.</span><br/><br/><span class="hl-0">A</span><span class="hl-1"> </span><span class="hl-2">contiuación</span><span class="hl-1"> </span><span class="hl-2">explicaremos</span><span class="hl-1"> </span><span class="hl-2">brevemente</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">código</span><span class="hl-1"> </span><span class="hl-2">para</span><span class="hl-1"> </span><span class="hl-2">cada</span><span class="hl-1"> </span><span class="hl-2">una</span><span class="hl-1"> </span><span class="hl-2">de</span><span class="hl-1"> </span><span class="hl-2">las</span><span class="hl-1"> </span><span class="hl-2">rutas.</span><br/><br/><span class="hl-3">#### ChallengeRouter.ts &lt;a name=&quot;challengeRouter&quot;&gt;&lt;/a&gt;</span><br/><br/><span class="hl-1">&gt; La ruta de los retos es la que se encarga de gestionar las peticiones relacionadas con los retos. Las peticiones que se pueden realizar son las siguientes:</span><br/><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">GET</span><span class="hl-1"> </span><span class="hl-2">/challenges:</span><span class="hl-1"> </span><span class="hl-2">devuelve</span><span class="hl-1"> </span><span class="hl-2">todos</span><span class="hl-1"> </span><span class="hl-2">los</span><span class="hl-1"> </span><span class="hl-2">retos.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">GET</span><span class="hl-1"> </span><span class="hl-2">/challenge/:id:</span><span class="hl-1"> </span><span class="hl-2">devuelve</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">reto</span><span class="hl-1"> </span><span class="hl-2">con</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">ID</span><span class="hl-1"> </span><span class="hl-2">especificado.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">GET</span><span class="hl-1"> </span><span class="hl-2">/challenge:</span><span class="hl-1"> </span><span class="hl-2">devuelve</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">reto</span><span class="hl-1"> </span><span class="hl-2">con</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">ID</span><span class="hl-1"> </span><span class="hl-2">especificado.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">POST</span><span class="hl-1"> </span><span class="hl-2">/challenge:</span><span class="hl-1"> </span><span class="hl-2">crea</span><span class="hl-1"> </span><span class="hl-2">un</span><span class="hl-1"> </span><span class="hl-2">nuevo</span><span class="hl-1"> </span><span class="hl-2">reto.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">PATCH</span><span class="hl-1"> </span><span class="hl-2">/challenge/:id:</span><span class="hl-1"> </span><span class="hl-2">actualiza</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">reto</span><span class="hl-1"> </span><span class="hl-2">con</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">ID</span><span class="hl-1"> </span><span class="hl-2">especificado.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">DELETE</span><span class="hl-1"> </span><span class="hl-2">/challenge/:id:</span><span class="hl-1"> </span><span class="hl-2">elimina</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">reto</span><span class="hl-1"> </span><span class="hl-2">con</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">ID</span><span class="hl-1"> </span><span class="hl-2">especificado.</span><br/><span class="hl-0">-</span><span class="hl-1"> </span><span class="hl-2">DELETE</span><span class="hl-1"> </span><span class="hl-2">/challenge:</span><span class="hl-1"> </span><span class="hl-2">elimina</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">reto</span><span class="hl-1"> </span><span class="hl-2">con</span><span class="hl-1"> </span><span class="hl-2">el</span><span class="hl-1"> </span><span class="hl-2">ID</span><span class="hl-1"> </span><span class="hl-2">especificado.</span><br/><br/><span class="hl-2">````</span><span class="hl-0">typescript</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">express</span><span class="hl-1"> </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-2">&#39;express&#39;</span><span class="hl-1">;</span><br/><span class="hl-0">import</span><span class="hl-1"> </span><span class="hl-2">{</span><span class="hl-1"> </span><span class="hl-2">createChallenge,</span><span class="hl-1"> </span><span class="hl-2">deleteChallenge,</span><span class="hl-1"> </span><span class="hl-2">getChallengeById,</span><span class="hl-1"> </span><span class="hl-2">getChallenges,</span><span class="hl-1"> </span><span class="hl-2">updateChallenge</span><span class="hl-1"> </span><span class="hl-2">}</span><span class="hl-1"> </span><span class="hl-2">from</span><span class="hl-1"> </span><span class="hl-2">&#39;../controllers/challenge.controller.js&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">const</span><span class="hl-1"> </span><span class="hl-2">router</span><span class="hl-1"> </span><span class="hl-2">=</span><span class="hl-1"> </span><span class="hl-2">express.Router</span><span class="hl-1">();</span><br/><br/><span class="hl-0">//</span><span class="hl-1"> </span><span class="hl-2">Grupos</span><span class="hl-1"> </span><span class="hl-2">para</span><span class="hl-1"> </span><span class="hl-2">usuarios</span><br/><span class="hl-0">router.get(</span><span class="hl-0">&#39;/challenges&#39;</span><span class="hl-0">,</span><span class="hl-1"> </span><span class="hl-2">getChallenges</span><span class="hl-1">);</span><br/><span class="hl-0">router.get(</span><span class="hl-0">&#39;/challenge/:id&#39;</span><span class="hl-0">,</span><span class="hl-1"> </span><span class="hl-2">getChallengeById</span><span class="hl-1">);</span><br/><span class="hl-0">router.get(</span><span class="hl-0">&#39;/challenge&#39;</span><span class="hl-0">,</span><span class="hl-1"> </span><span class="hl-2">getChallengeById</span><span class="hl-1">);</span><br/><span class="hl-0">router.post(</span><span class="hl-0">&#39;/challenge&#39;</span><span class="hl-0">,</span><span class="hl-1"> </span><span class="hl-2">createChallenge</span><span class="hl-1">);</span><br/><span class="hl-0">router.patch(</span><span class="hl-0">&#39;/challenge/:id&#39;</span><span class="hl-0">,</span><span class="hl-1"> </span><span class="hl-2">updateChallenge</span><span class="hl-1">);</span><br/><span class="hl-0">router.patch(</span><span class="hl-0">&#39;/challenge&#39;</span><span class="hl-0">,</span><span class="hl-1"> </span><span class="hl-2">updateChallenge</span><span class="hl-1">);</span><br/><span class="hl-0">router.delete(</span><span class="hl-0">&#39;/challenge/:id&#39;</span><span class="hl-0">,</span><span class="hl-1"> </span><span class="hl-2">deleteChallenge</span><span class="hl-1">);</span><br/><span class="hl-0">router.delete(</span><span class="hl-0">&#39;/challenge&#39;</span><span class="hl-0">,</span><span class="hl-1"> </span><span class="hl-2">deleteChallenge</span><span class="hl-1">);</span><br/><br/><span class="hl-4">export</span><span class="hl-1"> </span><span class="hl-2">default</span><span class="hl-1"> </span><span class="hl-2">router</span><span class="hl-1">;</span>
</code></pre>
<p>Este código crea un router de Express para manejar las diferentes rutas relacionadas con los retos o desafíos en una aplicación.</p>
<p>La función express.Router() crea una instancia de un objeto router de Express, el cual puede ser utilizado para crear rutas HTTP y asociarles funciones controladoras.</p>
<p>En este caso, el router tiene varias rutas:</p>
<ul>
<li>/challenges: Una ruta para obtener todos los retos existentes en la aplicación. Se utiliza el método HTTP GET.</li>
<li>/challenge/:id: Una ruta para obtener un reto específico por su ID. El ID del reto se especifica como un parámetro en la URL. Se utiliza el método HTTP GET.</li>
<li>/challenge: Una ruta para obtener un reto específico por su ID, pero se utiliza una solicitud POST en lugar de GET. Esto se debe a que no se puede especificar el ID del reto en la URL de la solicitud POST.</li>
<li>/challenge: Una ruta para crear un nuevo reto en la aplicación. Se utiliza el método HTTP POST.</li>
<li>/challenge/:id: Una ruta para actualizar un reto existente en la aplicación. El ID del reto se especifica como un parámetro en la URL. Se utiliza el método HTTP PATCH.</li>
<li>/challenge: Una ruta para actualizar un reto existente en la aplicación, pero se utiliza una solicitud PATCH en lugar de GET. Esto se debe a que no se puede especificar el ID del reto en la URL de la solicitud PATCH.</li>
<li>/challenge/:id: Una ruta para eliminar un reto existente en la aplicación. El ID del reto se especifica como un parámetro en la URL. Se utiliza el método HTTP DELETE.</li>
<li>/challenge: Una ruta para eliminar un reto existente en la aplicación, pero se utiliza una solicitud DELETE en lugar de GET. Esto se debe a que no se puede especificar el ID del reto en la URL de la solicitud DELETE.</li>
</ul>
<p>Cada ruta está asociada a una función controladora específica del módulo challenge.controller.js que se encarga de manejar la lógica de la aplicación para cada tipo de solicitud.</p>

<a href="#grouprouterts-" id="grouprouterts-" style="color: inherit; text-decoration: none;">
  <h4>GroupRouter.ts <a name="groupRouter"></a></h4>
</a>
<blockquote>
<p>La ruta de los grupos es la que se encarga de gestionar las peticiones relacionadas con los grupos. Las peticiones que se pueden realizar son las siguientes:</p>
</blockquote>
<ul>
<li>GET /groups: devuelve todos los grupos.</li>
<li>GET /group/:id: devuelve el grupo con el ID especificado.</li>
<li>GET /group: devuelve el grupo con el ID especificado.</li>
<li>POST /group: crea un nuevo grupo.</li>
<li>PATCH /group/:id: actualiza el grupo con el ID especificado.</li>
<li>PATCH /group: actualiza el grupo con el ID especificado.</li>
<li>PATCH /group/:id/addTrack: añade una ruta al historial de rutas del grupo con el ID especificado.</li>
<li>DELETE /group/:id: elimina el grupo con el ID especificado.</li>
<li>DELETE /group: elimina el grupo con el ID especificado.</li>
</ul>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> </span><span class="hl-6">express</span><span class="hl-1"> </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;express&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">createGroup</span><span class="hl-1">, </span><span class="hl-6">deleteGroup</span><span class="hl-1">, </span><span class="hl-6">getGroupById</span><span class="hl-1">, </span><span class="hl-6">getGroups</span><span class="hl-1">, </span><span class="hl-6">updateGroup</span><span class="hl-1">, </span><span class="hl-6">addTrackToHistory</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;../controllers/group.controller.js&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">router</span><span class="hl-1"> = </span><span class="hl-6">express</span><span class="hl-1">.</span><span class="hl-0">Router</span><span class="hl-1">();</span><br/><br/><span class="hl-3">// Grupos para usuarios</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">&#39;/groups&#39;</span><span class="hl-1">, </span><span class="hl-6">getGroups</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">&#39;/group/:id&#39;</span><span class="hl-1">, </span><span class="hl-6">getGroupById</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">&#39;/group&#39;</span><span class="hl-1">, </span><span class="hl-6">getGroupById</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">post</span><span class="hl-1">(</span><span class="hl-2">&#39;/group&#39;</span><span class="hl-1">, </span><span class="hl-6">createGroup</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">patch</span><span class="hl-1">(</span><span class="hl-2">&#39;/group/:id&#39;</span><span class="hl-1">, </span><span class="hl-6">updateGroup</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">patch</span><span class="hl-1">(</span><span class="hl-2">&#39;/group&#39;</span><span class="hl-1">, </span><span class="hl-6">updateGroup</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">patch</span><span class="hl-1">(</span><span class="hl-2">&#39;/group/:id/addTrack&#39;</span><span class="hl-1">, </span><span class="hl-6">addTrackToHistory</span><span class="hl-1">)</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">delete</span><span class="hl-1">(</span><span class="hl-2">&#39;/group/:id&#39;</span><span class="hl-1">, </span><span class="hl-6">deleteGroup</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">delete</span><span class="hl-1">(</span><span class="hl-2">&#39;/group&#39;</span><span class="hl-1">, </span><span class="hl-6">deleteGroup</span><span class="hl-1">);</span><br/><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-5">default</span><span class="hl-1"> </span><span class="hl-6">router</span><span class="hl-1">;</span>
</code></pre>
<p>Este código define un enrutador en Express para manejar las rutas relacionadas con los grupos de usuarios en la aplicación. La primera línea importa el paquete express. Luego, se importan una serie de controladores (createGroup, deleteGroup, getGroupById, getGroups, updateGroup, addTrackToHistory) desde el archivo group.controller.js.</p>
<p>El objeto router se crea mediante la llamada a la función express.Router(). Las rutas se definen a través de métodos HTTP en este objeto router. Cada uno de estos métodos especifica una ruta que coincide con una determinada URL, y una función que se ejecuta cuando se accede a esa ruta. Por ejemplo, el método get especifica una ruta para manejar una solicitud GET a una URL dada, mientras que el método post especifica una ruta para manejar una solicitud POST.</p>
<p>En este caso, las siguientes rutas están definidas en el objeto router:</p>
<ul>
<li>/groups: maneja una solicitud GET para obtener todos los grupos.</li>
<li>/group/:id: maneja una solicitud GET para obtener un grupo por su ID.</li>
<li>/group: maneja una solicitud GET para obtener un grupo.</li>
<li>/group: maneja una solicitud POST para crear un nuevo grupo.</li>
<li>/group/:id: maneja una solicitud PATCH para actualizar un grupo por su ID.</li>
<li>/group: maneja una solicitud PATCH para actualizar un grupo.</li>
<li>/group/:id/addTrack: maneja una solicitud PATCH para agregar una ruta a la historia de un grupo.</li>
<li>/group/:id: maneja una solicitud DELETE para eliminar un grupo por su ID.</li>
<li>/group: maneja una solicitud DELETE para eliminar un grupo.</li>
</ul>
<p>Por último, el objeto router se exporta como módulo predeterminado.</p>

<a href="#trackrouterts-" id="trackrouterts-" style="color: inherit; text-decoration: none;">
  <h4>TrackRouter.ts <a name="trackRouter"></a></h4>
</a>
<blockquote>
<p>La ruta de las rutas es la que se encarga de gestionar las peticiones relacionadas con las rutas. Las peticiones que se pueden realizar son las siguientes:</p>
</blockquote>
<ul>
<li>GET /tracks: devuelve todas las rutas.</li>
<li>GET /track/:id: devuelve la ruta con el ID especificado.</li>
<li>GET /track: devuelve la ruta con el ID especificado.</li>
<li>POST /track: crea una nueva ruta.</li>
<li>PATCH /track/:id: actualiza la ruta con el ID especificado.</li>
<li>PATCH /track: actualiza la ruta con el ID especificado.</li>
<li>DELETE /track/:id: elimina la ruta con el ID especificado.</li>
<li>DELETE /track: elimina la ruta con el ID especificado.</li>
</ul>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> </span><span class="hl-6">express</span><span class="hl-1"> </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;express&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">createTrack</span><span class="hl-1">, </span><span class="hl-6">deleteTrack</span><span class="hl-1">, </span><span class="hl-6">getTrackById</span><span class="hl-1">, </span><span class="hl-6">getTracks</span><span class="hl-1">, </span><span class="hl-6">updateTrack</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;../controllers/track.controller.js&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">router</span><span class="hl-1"> = </span><span class="hl-6">express</span><span class="hl-1">.</span><span class="hl-0">Router</span><span class="hl-1">();</span><br/><br/><span class="hl-3">// Rutas para usuarios</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">&#39;/tracks&#39;</span><span class="hl-1">, </span><span class="hl-6">getTracks</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">&#39;/track/:id&#39;</span><span class="hl-1">, </span><span class="hl-6">getTrackById</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">&#39;/track&#39;</span><span class="hl-1">, </span><span class="hl-6">getTrackById</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">post</span><span class="hl-1">(</span><span class="hl-2">&#39;/track&#39;</span><span class="hl-1">, </span><span class="hl-6">createTrack</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">patch</span><span class="hl-1">(</span><span class="hl-2">&#39;/track/:id&#39;</span><span class="hl-1">, </span><span class="hl-6">updateTrack</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">patch</span><span class="hl-1">(</span><span class="hl-2">&#39;/track&#39;</span><span class="hl-1">, </span><span class="hl-6">updateTrack</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">delete</span><span class="hl-1">(</span><span class="hl-2">&#39;/track/:id&#39;</span><span class="hl-1">, </span><span class="hl-6">deleteTrack</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">delete</span><span class="hl-1">(</span><span class="hl-2">&#39;/track&#39;</span><span class="hl-1">, </span><span class="hl-6">deleteTrack</span><span class="hl-1">);</span><br/><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-5">default</span><span class="hl-1"> </span><span class="hl-6">router</span><span class="hl-1">;</span>
</code></pre>
<p>Como en los casos anteriores definimos un enrutador para una aplicación de seguimiento de actividad física que permite a los usuarios crear, leer, actualizar y eliminar rutas de entrenamiento.</p>
<p>La primera línea del código importa el módulo express que se utiliza para crear la aplicación web. Luego se importan los controladores necesarios para realizar operaciones en las rutas.</p>
<p>El código crea un nuevo enrutador utilizando el método Router() de Express y asigna el enrutador a la variable router. Luego se definen varias rutas utilizando los métodos HTTP GET, POST, PATCH y DELETE. Cada ruta llama a un controlador específico para realizar la operación correspondiente en la base de datos.</p>
<p>Por último, el código exporta el enrutador como módulo predeterminado.</p>

<a href="#userrouterts-" id="userrouterts-" style="color: inherit; text-decoration: none;">
  <h4>UserRouter.ts <a name="userRouter"></a></h4>
</a>
<blockquote>
<p>La ruta de los usuarios es la que se encarga de gestionar las peticiones relacionadas con los usuarios. Las peticiones que se pueden realizar son las siguientes:</p>
</blockquote>
<ul>
<li>GET /users: devuelve todos los usuarios.</li>
<li>GET /user/:id: devuelve el usuario con el ID especificado.</li>
<li>GET /user: devuelve el usuario con el ID especificado.</li>
<li>POST /user: crea un nuevo usuario.</li>
<li>PATCH /user/:id: actualiza el usuario con el ID especificado.</li>
<li>PATCH /user: actualiza el usuario con el ID especificado.</li>
<li>PATCH /user/:id/addTrack: añade una ruta al historial de rutas del usuario con el ID especificado.</li>
<li>DELETE /user/:id: elimina el usuario con el ID especificado.</li>
<li>DELETE /user: elimina el usuario con el ID especificado.</li>
</ul>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> </span><span class="hl-6">express</span><span class="hl-1"> </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;express&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">createUser</span><span class="hl-1">, </span><span class="hl-6">deleteUser</span><span class="hl-1">, </span><span class="hl-6">getUserById</span><span class="hl-1">, </span><span class="hl-6">getUsers</span><span class="hl-1">, </span><span class="hl-6">updateUser</span><span class="hl-1">, </span><span class="hl-6">addTrackToHistory</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;../controllers/user.controller.js&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">router</span><span class="hl-1"> = </span><span class="hl-6">express</span><span class="hl-1">.</span><span class="hl-0">Router</span><span class="hl-1">();</span><br/><br/><span class="hl-3">// Rutas para usuarios</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">&#39;/users&#39;</span><span class="hl-1">, </span><span class="hl-6">getUsers</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">&#39;/user/:id&#39;</span><span class="hl-1">, </span><span class="hl-6">getUserById</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">&#39;/user&#39;</span><span class="hl-1">, </span><span class="hl-6">getUserById</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">post</span><span class="hl-1">(</span><span class="hl-2">&#39;/user&#39;</span><span class="hl-1">, </span><span class="hl-6">createUser</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">patch</span><span class="hl-1">(</span><span class="hl-2">&#39;/user/:id&#39;</span><span class="hl-1">, </span><span class="hl-6">updateUser</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">patch</span><span class="hl-1">(</span><span class="hl-2">&#39;/user&#39;</span><span class="hl-1">, </span><span class="hl-6">updateUser</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">delete</span><span class="hl-1">(</span><span class="hl-2">&#39;/user/:id&#39;</span><span class="hl-1">, </span><span class="hl-6">deleteUser</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">delete</span><span class="hl-1">(</span><span class="hl-2">&#39;/user&#39;</span><span class="hl-1">, </span><span class="hl-6">deleteUser</span><span class="hl-1">);</span><br/><span class="hl-6">router</span><span class="hl-1">.</span><span class="hl-0">patch</span><span class="hl-1">(</span><span class="hl-2">&#39;/user/:id/addTrack&#39;</span><span class="hl-1">, </span><span class="hl-6">addTrackToHistory</span><span class="hl-1">)</span><br/><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-5">default</span><span class="hl-1"> </span><span class="hl-6">router</span><span class="hl-1">;</span>
</code></pre>
<p>Como hemos venido haciendo, se definen un conjunto de rutas HTTP para interactuar con recursos de usuario en una aplicación web, utilizando el marco de trabajo de Express. Las rutas se definen en un objeto Router, que es exportado para ser utilizado por la aplicación principal.</p>
<p>El código importa varias funciones desde el módulo ../controllers/user.controller.js, que probablemente implementa la lógica del negocio para manejar las solicitudes de la API. Cada una de estas funciones se asigna a una ruta HTTP específica, utilizando los métodos correspondientes de Express Router. Por ejemplo, el método get se utiliza para manejar solicitudes GET, mientras que el método post se utiliza para manejar solicitudes POST. Las rutas se definen utilizando el método Router.METHOD(PATH, HANDLER), donde METHOD es un método HTTP (por ejemplo, get, post, patch, delete), PATH es una cadena que representa la ruta a manejar y HANDLER es la función que se ejecutará cuando se haga una solicitud a esa ruta.</p>

<a href="#controladores-" id="controladores-" style="color: inherit; text-decoration: none;">
  <h3>Controladores <a name="controladores"></a></h3>
</a>
<blockquote>
<p><a href="#%C3%ADndice">Volver al índice</a></p>
</blockquote>
<blockquote>
<p>En la carpeta controllers se encuentran los controladores de la aplicación. Estos controladores son los que se encargan de realizar las operaciones de la API. Este conjunto de controladores es el que que maneja mediante funciones la información de las diferentes peticiones HTTP en una API construida con el framework Express y utilizando una base de datos MongoDB alojada en Atlas.</p>
</blockquote>
<p>La API se utiliza para interactuar con una base de datos que contiene información sobre grupos de corredores y las rutas que han recorrido.</p>
<p>Los controladores son los siguientes:</p>
<ul>
<li>challenge.controller.ts: controlador de los retos.</li>
<li>group.controller.ts: controlador de los grupos.</li>
<li>track.controller.ts: controlador de las rutas.</li>
<li>user.controller.ts: controlador de los usuarios.</li>
</ul>
<p>A contiuación explicaremos brevemente la estructura de cada uno de los controladores.</p>

<a href="#challengecontrollerts-" id="challengecontrollerts-" style="color: inherit; text-decoration: none;">
  <h4>ChallengeController.ts <a name="challengeController"></a></h4>
</a>
<blockquote>
<p>El controlador de los retos es el que se encarga de gestionar las peticiones relacionadas con los retos:</p>
</blockquote>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">Request</span><span class="hl-1">, </span><span class="hl-6">Response</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;express&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">challengeModel</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;../models/challengeSchema.js&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">challengeLongAndUnevennes</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;../utils/functions.js&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-3">// Obtener todos los Retos</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-0">getChallenges</span><span class="hl-1"> = </span><span class="hl-4">async</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">: </span><span class="hl-8">Request</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">: </span><span class="hl-8">Response</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">try</span><span class="hl-1"> {</span><br/><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">challenges</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">challengeModel</span><span class="hl-1">.</span><span class="hl-0">find</span><span class="hl-1">().</span><span class="hl-0">populate</span><span class="hl-1">(</span><span class="hl-2">&#39;tracks&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-3">//Añadir a cada challenge la distancia total de sus tracks y el desnivel medio</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">challengesfinal</span><span class="hl-1"> = </span><span class="hl-0">challengeLongAndUnevennes</span><span class="hl-1">(</span><span class="hl-6">challenges</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">(</span><span class="hl-6">challengesfinal</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Retos obtenidos correctamente&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  } </span><span class="hl-5">catch</span><span class="hl-1"> (</span><span class="hl-6">error</span><span class="hl-1"> : </span><span class="hl-8">any</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">500</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1">.</span><span class="hl-6">message</span><span class="hl-1"> });</span><br/><span class="hl-1">    </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Error al obtener los retos&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-3">// Obtener una Reto por su ID</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-0">getChallengeById</span><span class="hl-1"> = </span><span class="hl-4">async</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">: </span><span class="hl-8">Request</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">: </span><span class="hl-8">Response</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">query</span><span class="hl-1"> = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">query</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-6">query</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">Challenge</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">challengeModel</span><span class="hl-1">.</span><span class="hl-0">findOne</span><span class="hl-1">({ </span><span class="hl-6">id:</span><span class="hl-1"> </span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1"> }).</span><span class="hl-0">populate</span><span class="hl-1">(</span><span class="hl-2">&#39;tracks&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-5">if</span><span class="hl-1"> (!</span><span class="hl-6">Challenge</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">404</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Reto no encontrado&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">challengesfinal</span><span class="hl-1"> = </span><span class="hl-0">challengeLongAndUnevennes</span><span class="hl-1">([</span><span class="hl-6">Challenge</span><span class="hl-1">]);</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">(</span><span class="hl-6">challengesfinal</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> { </span><span class="hl-7">id</span><span class="hl-1"> } = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">params</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">Challenge</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">challengeModel</span><span class="hl-1">.</span><span class="hl-0">findById</span><span class="hl-1">(</span><span class="hl-6">id</span><span class="hl-1">).</span><span class="hl-0">populate</span><span class="hl-1">(</span><span class="hl-2">&#39;tracks&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-5">if</span><span class="hl-1"> (!</span><span class="hl-6">Challenge</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">404</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Reto no encontrado&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">challengesfinal</span><span class="hl-1"> = </span><span class="hl-0">challengeLongAndUnevennes</span><span class="hl-1">([</span><span class="hl-6">Challenge</span><span class="hl-1">]);</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">(</span><span class="hl-6">challengesfinal</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  } </span><span class="hl-5">catch</span><span class="hl-1"> (</span><span class="hl-6">error</span><span class="hl-1"> : </span><span class="hl-8">any</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">500</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1">.</span><span class="hl-6">message</span><span class="hl-1"> });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-3">// Crear una nueva Reto</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-0">createChallenge</span><span class="hl-1"> = </span><span class="hl-4">async</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">: </span><span class="hl-8">Request</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">: </span><span class="hl-8">Response</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">challenge</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">challengeModel</span><span class="hl-1">(</span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">body</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">challenge</span><span class="hl-1">.</span><span class="hl-0">save</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Reto creado correctamente&#39;</span><span class="hl-1"> , </span><span class="hl-6">challenge</span><span class="hl-1"> });</span><br/><span class="hl-1">  } </span><span class="hl-5">catch</span><span class="hl-1"> (</span><span class="hl-6">error</span><span class="hl-1"> : </span><span class="hl-8">any</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">500</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1">.</span><span class="hl-6">message</span><span class="hl-1"> });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-3">// Actualizar una Reto existente</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-0">updateChallenge</span><span class="hl-1"> = </span><span class="hl-4">async</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">: </span><span class="hl-8">Request</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">: </span><span class="hl-8">Response</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">query</span><span class="hl-1"> = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">query</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-6">query</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">Challenge</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">challengeModel</span><span class="hl-1">.</span><span class="hl-0">findOneAndUpdate</span><span class="hl-1">({ </span><span class="hl-6">id:</span><span class="hl-1"> </span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1"> }, </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">body</span><span class="hl-1">, { </span><span class="hl-6">new:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1"> });</span><br/><span class="hl-1">      </span><span class="hl-5">if</span><span class="hl-1"> (!</span><span class="hl-6">Challenge</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">404</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Reto no encontrado&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Reto actualizado correctamente&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> { </span><span class="hl-7">id</span><span class="hl-1"> } = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">params</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">Challenge</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">challengeModel</span><span class="hl-1">.</span><span class="hl-0">findByIdAndUpdate</span><span class="hl-1">(</span><span class="hl-6">id</span><span class="hl-1">, </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">body</span><span class="hl-1">, { </span><span class="hl-6">new:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1"> });</span><br/><span class="hl-1">      </span><span class="hl-5">if</span><span class="hl-1"> (!</span><span class="hl-6">Challenge</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">404</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Reto no encontrado&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Reto actualizado correctamente&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  } </span><span class="hl-5">catch</span><span class="hl-1"> (</span><span class="hl-6">error</span><span class="hl-1"> : </span><span class="hl-8">any</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">500</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1">.</span><span class="hl-6">message</span><span class="hl-1"> });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-3">// Eliminar una Reto existente</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-0">deleteChallenge</span><span class="hl-1"> = </span><span class="hl-4">async</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">: </span><span class="hl-8">Request</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">: </span><span class="hl-8">Response</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">query</span><span class="hl-1"> = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">query</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-6">query</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">Challenge</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">challengeModel</span><span class="hl-1">.</span><span class="hl-0">findOneAndDelete</span><span class="hl-1">({ </span><span class="hl-6">id:</span><span class="hl-1"> </span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1"> });</span><br/><span class="hl-1">      </span><span class="hl-5">if</span><span class="hl-1"> (!</span><span class="hl-6">Challenge</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">404</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Reto no encontrado&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Reto borrado correctamente&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> { </span><span class="hl-7">id</span><span class="hl-1"> } = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">params</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">Challenge</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">challengeModel</span><span class="hl-1">.</span><span class="hl-0">findByIdAndDelete</span><span class="hl-1">(</span><span class="hl-6">id</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-5">if</span><span class="hl-1"> (!</span><span class="hl-6">Challenge</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">404</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Reto no encontrado&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Reto borrado correctamente&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  } </span><span class="hl-5">catch</span><span class="hl-1"> (</span><span class="hl-6">error</span><span class="hl-1"> : </span><span class="hl-8">any</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">500</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1">.</span><span class="hl-6">message</span><span class="hl-1"> });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span><br/><span class="hl-2">````</span><span class="hl-1">	</span><br/><span class="hl-6">La</span><span class="hl-1"> </span><span class="hl-6">primera</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1">, </span><span class="hl-6">getChallenges</span><span class="hl-1">, </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">encarga</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">obtener</span><span class="hl-1"> </span><span class="hl-6">todos</span><span class="hl-1"> </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">retos</span><span class="hl-1"> </span><span class="hl-6">almacenados</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1">, </span><span class="hl-6">calcular</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">distancia</span><span class="hl-1"> </span><span class="hl-6">total</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">tracks</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">cada</span><span class="hl-1"> </span><span class="hl-6">uno</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">su</span><span class="hl-1"> </span><span class="hl-6">desnivel</span><span class="hl-1"> </span><span class="hl-6">medio</span><span class="hl-1">, </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">devolver</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">respuesta</span><span class="hl-1"> </span><span class="hl-7">HTTP</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">código</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">estado</span><span class="hl-1"> </span><span class="hl-9">200</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">objeto</span><span class="hl-1"> </span><span class="hl-7">JSON</span><span class="hl-1"> </span><span class="hl-6">que</span><span class="hl-1"> </span><span class="hl-6">contiene</span><span class="hl-1"> </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">retos</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">su</span><span class="hl-1"> </span><span class="hl-6">información</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">distancia</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">desnivel</span><span class="hl-1">.</span><br/><br/><span class="hl-6">La</span><span class="hl-1"> </span><span class="hl-6">segunda</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1">, </span><span class="hl-6">getChallengeById</span><span class="hl-1">, </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">encarga</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">obtener</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">reto</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">específico</span><span class="hl-1">, </span><span class="hl-6">ya</span><span class="hl-1"> </span><span class="hl-6">sea</span><span class="hl-1"> </span><span class="hl-6">por</span><span class="hl-1"> </span><span class="hl-6">su</span><span class="hl-1"> </span><span class="hl-0">ID</span><span class="hl-1"> (</span><span class="hl-6">cuando</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">pasa</span><span class="hl-1"> </span><span class="hl-6">como</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">parámetro</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">consulta</span><span class="hl-1">) </span><span class="hl-6">o</span><span class="hl-1"> </span><span class="hl-6">por</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-7">ID</span><span class="hl-1"> </span><span class="hl-6">que</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">encuentra</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">parámetros</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-7">URL</span><span class="hl-1">. </span><span class="hl-6">La</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1"> </span><span class="hl-6">también</span><span class="hl-1"> </span><span class="hl-6">calcula</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">distancia</span><span class="hl-1"> </span><span class="hl-6">total</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">desnivel</span><span class="hl-1"> </span><span class="hl-6">medio</span><span class="hl-1"> </span><span class="hl-6">del</span><span class="hl-1"> </span><span class="hl-6">reto</span><span class="hl-1"> </span><span class="hl-6">antes</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">devolver</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">respuesta</span><span class="hl-1"> </span><span class="hl-7">HTTP</span><span class="hl-1">.</span><br/><br/><span class="hl-6">La</span><span class="hl-1"> </span><span class="hl-6">tercera</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1">, </span><span class="hl-6">createChallenge</span><span class="hl-1">, </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">encarga</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">crear</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">nuevo</span><span class="hl-1"> </span><span class="hl-6">reto</span><span class="hl-1"> </span><span class="hl-6">a</span><span class="hl-1"> </span><span class="hl-6">partir</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">información</span><span class="hl-1"> </span><span class="hl-6">proporcionada</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">petición</span><span class="hl-1"> </span><span class="hl-7">HTTP</span><span class="hl-1">. </span><span class="hl-6">El</span><span class="hl-1"> </span><span class="hl-6">objeto</span><span class="hl-1"> </span><span class="hl-7">JSON</span><span class="hl-1"> </span><span class="hl-6">que</span><span class="hl-1"> </span><span class="hl-6">representa</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">nuevo</span><span class="hl-1"> </span><span class="hl-6">reto</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">guarda</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">devuelve</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">respuesta</span><span class="hl-1"> </span><span class="hl-7">HTTP</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">código</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">estado</span><span class="hl-1"> </span><span class="hl-9">200</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">mensaje</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">confirmación</span><span class="hl-1">.</span><br/><br/><span class="hl-6">La</span><span class="hl-1"> </span><span class="hl-6">cuarta</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1">, </span><span class="hl-6">updateChallenge</span><span class="hl-1">, </span><span class="hl-6">actualiza</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">reto</span><span class="hl-1"> </span><span class="hl-6">existente</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1">, </span><span class="hl-6">ya</span><span class="hl-1"> </span><span class="hl-6">sea</span><span class="hl-1"> </span><span class="hl-6">por</span><span class="hl-1"> </span><span class="hl-6">su</span><span class="hl-1"> </span><span class="hl-0">ID</span><span class="hl-1"> (</span><span class="hl-6">pasado</span><span class="hl-1"> </span><span class="hl-6">como</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">parámetro</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">consulta</span><span class="hl-1">) </span><span class="hl-6">o</span><span class="hl-1"> </span><span class="hl-6">por</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-7">ID</span><span class="hl-1"> </span><span class="hl-6">que</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">encuentra</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">parámetros</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-7">URL</span><span class="hl-1">. </span><span class="hl-6">La</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1"> </span><span class="hl-6">utiliza</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">información</span><span class="hl-1"> </span><span class="hl-6">proporcionada</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">petición</span><span class="hl-1"> </span><span class="hl-7">HTTP</span><span class="hl-1"> </span><span class="hl-6">para</span><span class="hl-1"> </span><span class="hl-6">actualizar</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">reto</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">devuelve</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">respuesta</span><span class="hl-1"> </span><span class="hl-7">HTTP</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">código</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">estado</span><span class="hl-1"> </span><span class="hl-9">200</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">mensaje</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">confirmación</span><span class="hl-1">.</span><br/><br/><span class="hl-6">La</span><span class="hl-1"> </span><span class="hl-6">quinta</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1">, </span><span class="hl-6">deleteChallenge</span><span class="hl-1">, </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">encarga</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">eliminar</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">reto</span><span class="hl-1"> </span><span class="hl-6">existente</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1">, </span><span class="hl-6">ya</span><span class="hl-1"> </span><span class="hl-6">sea</span><span class="hl-1"> </span><span class="hl-6">por</span><span class="hl-1"> </span><span class="hl-6">su</span><span class="hl-1"> </span><span class="hl-0">ID</span><span class="hl-1"> (</span><span class="hl-6">pasado</span><span class="hl-1"> </span><span class="hl-6">como</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">parámetro</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">consulta</span><span class="hl-1">) </span><span class="hl-6">o</span><span class="hl-1"> </span><span class="hl-6">por</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-7">ID</span><span class="hl-1"> </span><span class="hl-6">que</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">encuentra</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">parámetros</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-7">URL</span><span class="hl-1">. </span><span class="hl-6">La</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1"> </span><span class="hl-6">elimina</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">reto</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">devuelve</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">respuesta</span><span class="hl-1"> </span><span class="hl-7">HTTP</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">código</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">estado</span><span class="hl-1"> </span><span class="hl-9">200</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">mensaje</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">confirmación</span><span class="hl-1">.</span><br/><br/><span class="hl-1">#### </span><span class="hl-6">GroupController</span><span class="hl-1">.</span><span class="hl-6">ts</span><span class="hl-1"> &lt;</span><span class="hl-6">a</span><span class="hl-1"> </span><span class="hl-6">name</span><span class="hl-1">=</span><span class="hl-2">&quot;groupController&quot;</span><span class="hl-1">&gt;&lt;/</span><span class="hl-8">a</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-6">El</span><span class="hl-1"> </span><span class="hl-6">controlador</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">grupos</span><span class="hl-1"> </span><span class="hl-6">contiene</span><span class="hl-1"> </span><span class="hl-6">las</span><span class="hl-1"> </span><span class="hl-6">funciones</span><span class="hl-1"> </span><span class="hl-6">necesarias</span><span class="hl-1"> </span><span class="hl-6">para</span><span class="hl-1"> </span><span class="hl-6">gestionar</span><span class="hl-1"> </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">grupos</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">usuarios</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">aplicación</span><span class="hl-1">. </span><br/><br/><span class="hl-2">````</span><span class="hl-6">typescript</span><span class="hl-1">	</span><br/><span class="hl-5">import</span><span class="hl-1"> </span><span class="hl-6">chai</span><span class="hl-1"> </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;chai&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> </span><span class="hl-6">chaiHttp</span><span class="hl-1"> </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;chai-http&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1"> </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;../dist/index.js&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">expect</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;chai&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> </span><span class="hl-2">&#39;mocha&#39;</span><br/><br/><span class="hl-6">chai</span><span class="hl-1">.</span><span class="hl-0">use</span><span class="hl-1">(</span><span class="hl-6">chaiHttp</span><span class="hl-1">);</span><br/><span class="hl-0">describe</span><span class="hl-1">(</span><span class="hl-2">&#39;Group routes&#39;</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-6">_idTestGroup</span><span class="hl-1">: </span><span class="hl-8">string</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-4">let</span><span class="hl-1"> </span><span class="hl-6">server</span><span class="hl-1">: </span><span class="hl-8">any</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">testGroup1</span><span class="hl-1"> = {</span><br/><span class="hl-1">      </span><span class="hl-6">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;GroupTest1&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-6">name:</span><span class="hl-1"> </span><span class="hl-2">&#39;Test&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-6">participants:</span><span class="hl-1"> [],</span><br/><span class="hl-1">      </span><span class="hl-6">historicTracks:</span><span class="hl-1"> [],</span><br/><span class="hl-1">     </span><br/><span class="hl-1">    };</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">testGroup1Modi</span><span class="hl-1"> = {</span><br/><span class="hl-1">        </span><span class="hl-6">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;GroupTest1&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-6">name:</span><span class="hl-1"> </span><span class="hl-2">&#39;Test changed&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">testGroup2</span><span class="hl-1"> = {</span><br/><span class="hl-1">        </span><span class="hl-6">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;GroupTest2&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-6">name:</span><span class="hl-1"> </span><span class="hl-2">&#39;Test&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">       </span><br/><span class="hl-1">      };</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">testGroup2Modi</span><span class="hl-1"> = {</span><br/><span class="hl-1">        </span><span class="hl-6">id:</span><span class="hl-1"> </span><span class="hl-2">&quot;GroupTest2&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><span class="hl-6">name:</span><span class="hl-1"> </span><span class="hl-2">&#39;Test changed&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">        </span><br/><span class="hl-1">      }</span><br/><span class="hl-1">      </span><br/><span class="hl-1">    </span><span class="hl-0">describe</span><span class="hl-1">(</span><span class="hl-2">&#39;POST /:group&#39;</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-3">//Crear usuarios</span><br/><span class="hl-1">        </span><span class="hl-0">it</span><span class="hl-1">(</span><span class="hl-2">&#39;should add a testGroup1&#39;</span><span class="hl-1">, (</span><span class="hl-6">done</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">chai</span><br/><span class="hl-1">            .</span><span class="hl-0">request</span><span class="hl-1">(</span><span class="hl-6">app</span><span class="hl-1">)</span><br/><span class="hl-1">            .</span><span class="hl-0">post</span><span class="hl-1">(</span><span class="hl-2">`/groups/group`</span><span class="hl-1">)</span><br/><span class="hl-1">            .</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-2">&#39;Content-Type&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;application/json&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">            .</span><span class="hl-0">send</span><span class="hl-1">(</span><span class="hl-6">testGroup1</span><span class="hl-1">)</span><br/><span class="hl-1">            .</span><span class="hl-0">end</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-6">_idTestGroup</span><span class="hl-1"> = </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-6">body</span><span class="hl-1">.</span><span class="hl-6">group</span><span class="hl-1">.</span><span class="hl-6">_id</span><br/><span class="hl-1">            </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;GROUP: &quot;</span><span class="hl-1">)</span><br/><span class="hl-1">            </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-6">_idTestGroup</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-0">expect</span><span class="hl-1">(</span><span class="hl-6">err</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">null</span><span class="hl-1">;</span><br/><span class="hl-1">            </span><span class="hl-0">expect</span><span class="hl-1">(</span><span class="hl-6">res</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><br/><span class="hl-1">            </span><span class="hl-0">done</span><span class="hl-1">();</span><br/><span class="hl-1">            });</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">        </span><span class="hl-0">it</span><span class="hl-1">(</span><span class="hl-2">&#39;should add a testGroup2&#39;</span><span class="hl-1">, (</span><span class="hl-6">done</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-6">chai</span><br/><span class="hl-1">                .</span><span class="hl-0">request</span><span class="hl-1">(</span><span class="hl-6">app</span><span class="hl-1">)</span><br/><span class="hl-1">                .</span><span class="hl-0">post</span><span class="hl-1">(</span><span class="hl-2">`/groups/group`</span><span class="hl-1">)</span><br/><span class="hl-1">                .</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-2">&#39;Content-Type&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;application/json&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">                .</span><span class="hl-0">send</span><span class="hl-1">(</span><span class="hl-6">testGroup2</span><span class="hl-1">)</span><br/><span class="hl-1">                .</span><span class="hl-0">end</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">                </span><span class="hl-0">expect</span><span class="hl-1">(</span><span class="hl-6">err</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">null</span><span class="hl-1">;</span><br/><span class="hl-1">                </span><span class="hl-0">expect</span><span class="hl-1">(</span><span class="hl-6">res</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">);</span><br/><span class="hl-1">                </span><span class="hl-0">done</span><span class="hl-1">();</span><br/><span class="hl-1">                });</span><br/><span class="hl-1">            });</span><br/><span class="hl-1">       </span><br/><span class="hl-1">    </span><span class="hl-3">//Errores al crear usuarios</span><br/><span class="hl-1">    </span><span class="hl-0">it</span><span class="hl-1">(</span><span class="hl-2">&#39;should give us an error when try to add a new thats not correct&#39;</span><span class="hl-1">, (</span><span class="hl-6">done</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">chai</span><br/><span class="hl-1">            .</span><span class="hl-0">request</span><span class="hl-1">(</span><span class="hl-6">app</span><span class="hl-1">)</span><br/><span class="hl-1">            .</span><span class="hl-0">post</span><span class="hl-1">(</span><span class="hl-2">`/groups/group`</span><span class="hl-1">)</span><br/><span class="hl-1">            .</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-2">&#39;Content-Type&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;application/json&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">            .</span><span class="hl-0">send</span><span class="hl-1">({</span><span class="hl-6">id:</span><span class="hl-1"> </span><span class="hl-6">testGroup1</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">, </span><span class="hl-6">name :</span><span class="hl-1"> </span><span class="hl-6">testGroup1</span><span class="hl-1">.</span><span class="hl-6">name</span><span class="hl-1">})</span><br/><span class="hl-1">            .</span><span class="hl-0">end</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-0">expect</span><span class="hl-1">(</span><span class="hl-6">res</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">500</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-0">done</span><span class="hl-1">();</span><br/><span class="hl-1">            });</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-3">//Modificar usuarios</span><br/><span class="hl-1">   </span><span class="hl-0">describe</span><span class="hl-1">(</span><span class="hl-2">&#39;PATCH /:Group&#39;</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">it</span><span class="hl-1">(</span><span class="hl-2">&#39;Should change name of testGroup1 by id&#39;</span><span class="hl-1">, (</span><span class="hl-6">done</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-6">chai</span><br/><span class="hl-1">                .</span><span class="hl-0">request</span><span class="hl-1">(</span><span class="hl-6">app</span><span class="hl-1">)</span><br/><span class="hl-1">                .</span><span class="hl-0">patch</span><span class="hl-1">(</span><span class="hl-2">`/groups/group/</span><span class="hl-4">${</span><span class="hl-6">_idTestGroup</span><span class="hl-4">}</span><span class="hl-2">`</span><span class="hl-1">)</span><br/><span class="hl-1">                .</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-2">&#39;Content-Type&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;application/json&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">                .</span><span class="hl-0">send</span><span class="hl-1">(</span><span class="hl-6">testGroup1Modi</span><span class="hl-1">)</span><br/><span class="hl-1">                .</span><span class="hl-0">end</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">                </span><span class="hl-0">expect</span><span class="hl-1">(</span><span class="hl-6">err</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">null</span><span class="hl-1">;</span><br/><span class="hl-1">                </span><span class="hl-0">expect</span><span class="hl-1">(</span><span class="hl-6">res</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">);</span><br/><span class="hl-1">                </span><span class="hl-0">done</span><span class="hl-1">();</span><br/><span class="hl-1">                });</span><br/><span class="hl-1">            });</span><br/><span class="hl-1">        </span><span class="hl-0">it</span><span class="hl-1">(</span><span class="hl-2">&#39;Should change name of testGroup2 by query&#39;</span><span class="hl-1">, (</span><span class="hl-6">done</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">                </span><span class="hl-6">chai</span><br/><span class="hl-1">                    .</span><span class="hl-0">request</span><span class="hl-1">(</span><span class="hl-6">app</span><span class="hl-1">)</span><br/><span class="hl-1">                    .</span><span class="hl-0">patch</span><span class="hl-1">(</span><span class="hl-2">`/groups/group/?id=GroupTest2`</span><span class="hl-1">)</span><br/><span class="hl-1">                    .</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-2">&#39;Content-Type&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;application/json&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">                    .</span><span class="hl-0">send</span><span class="hl-1">(</span><span class="hl-6">testGroup2Modi</span><span class="hl-1">)</span><br/><span class="hl-1">                    .</span><span class="hl-0">end</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">                    </span><span class="hl-0">expect</span><span class="hl-1">(</span><span class="hl-6">err</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">be</span><span class="hl-1">.</span><span class="hl-6">null</span><span class="hl-1">;</span><br/><span class="hl-1">                    </span><span class="hl-0">expect</span><span class="hl-1">(</span><span class="hl-6">res</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">);</span><br/><span class="hl-1">                    </span><span class="hl-0">done</span><span class="hl-1">();</span><br/><span class="hl-1">                    });</span><br/><span class="hl-1">                });</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-3">//Obtener usuarios</span><br/><span class="hl-1">    </span><span class="hl-0">describe</span><span class="hl-1">(</span><span class="hl-2">&#39;GET /:Group&#39;</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">it</span><span class="hl-1">(</span><span class="hl-2">&#39;should all the Groups&#39;</span><span class="hl-1">, (</span><span class="hl-6">done</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-6">chai</span><br/><span class="hl-1">                .</span><span class="hl-0">request</span><span class="hl-1">(</span><span class="hl-6">app</span><span class="hl-1">)</span><br/><span class="hl-1">                .</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">`/groups/groups`</span><span class="hl-1">)</span><br/><span class="hl-1">                .</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-2">&#39;Content-Type&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;application/json&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">                .</span><span class="hl-0">end</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">                </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-6">body</span><span class="hl-1">)</span><br/><span class="hl-1">                </span><span class="hl-0">expect</span><span class="hl-1">(</span><span class="hl-6">res</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">);</span><br/><span class="hl-1">                </span><span class="hl-0">done</span><span class="hl-1">();</span><br/><span class="hl-1">                });</span><br/><span class="hl-1">            });</span><br/><span class="hl-1">            </span><span class="hl-0">it</span><span class="hl-1">(</span><span class="hl-2">&#39;should get testGroup1 by id&#39;</span><span class="hl-1">, (</span><span class="hl-6">done</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">                </span><span class="hl-6">chai</span><br/><span class="hl-1">                    .</span><span class="hl-0">request</span><span class="hl-1">(</span><span class="hl-6">app</span><span class="hl-1">)</span><br/><span class="hl-1">                    .</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">`/groups/group/</span><span class="hl-4">${</span><span class="hl-6">_idTestGroup</span><span class="hl-4">}</span><span class="hl-2">`</span><span class="hl-1">)</span><br/><span class="hl-1">                    .</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-2">&#39;Content-Type&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;application/json&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">                    .</span><span class="hl-0">end</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">                    </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-6">body</span><span class="hl-1">)</span><br/><span class="hl-1">                    </span><span class="hl-0">expect</span><span class="hl-1">(</span><span class="hl-6">res</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">);</span><br/><span class="hl-1">                    </span><span class="hl-0">done</span><span class="hl-1">();</span><br/><span class="hl-1">                    });</span><br/><span class="hl-1">                });</span><br/><span class="hl-1">                </span><span class="hl-0">it</span><span class="hl-1">(</span><span class="hl-2">&#39;should get testGroup2 by _query&#39;</span><span class="hl-1">, (</span><span class="hl-6">done</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">                    </span><span class="hl-6">chai</span><br/><span class="hl-1">                        .</span><span class="hl-0">request</span><span class="hl-1">(</span><span class="hl-6">app</span><span class="hl-1">)</span><br/><span class="hl-1">                        .</span><span class="hl-0">get</span><span class="hl-1">(</span><span class="hl-2">`/groups/group/?id=GroupTest2`</span><span class="hl-1">)</span><br/><span class="hl-1">                        .</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-2">&#39;Content-Type&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;application/json&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">                        .</span><span class="hl-0">end</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">                        </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-6">body</span><span class="hl-1">)</span><br/><span class="hl-1">                        </span><span class="hl-0">expect</span><span class="hl-1">(</span><span class="hl-6">res</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">);</span><br/><span class="hl-1">                        </span><span class="hl-0">done</span><span class="hl-1">();</span><br/><span class="hl-1">                        });</span><br/><span class="hl-1">                    });</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">    </span><span class="hl-3">//Borrar usuarios</span><br/><span class="hl-1">    </span><br/><span class="hl-1">    </span><span class="hl-0">describe</span><span class="hl-1">(</span><span class="hl-2">&#39;Delete /?Group&#39;</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-0">it</span><span class="hl-1">(</span><span class="hl-2">&#39;should delete the tests Group 1 by id&#39;</span><span class="hl-1">, (</span><span class="hl-6">done</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-6">chai</span><br/><span class="hl-1">                .</span><span class="hl-0">request</span><span class="hl-1">(</span><span class="hl-6">app</span><span class="hl-1">)</span><br/><span class="hl-1">                .</span><span class="hl-0">delete</span><span class="hl-1">(</span><span class="hl-2">`/groups/group/</span><span class="hl-4">${</span><span class="hl-6">_idTestGroup</span><span class="hl-4">}</span><span class="hl-2">`</span><span class="hl-1">)</span><br/><span class="hl-1">                .</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-2">&#39;Content-Type&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;application/json&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">                .</span><span class="hl-0">end</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">                </span><span class="hl-0">expect</span><span class="hl-1">(</span><span class="hl-6">res</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">);</span><br/><span class="hl-1">                </span><span class="hl-0">done</span><span class="hl-1">();</span><br/><span class="hl-1">                });</span><br/><span class="hl-1">            });</span><br/><span class="hl-1">        </span><span class="hl-0">it</span><span class="hl-1">(</span><span class="hl-2">&#39;should delete the tests Group 2 by query&#39;</span><span class="hl-1">, (</span><span class="hl-6">done</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">chai</span><br/><span class="hl-1">            .</span><span class="hl-0">request</span><span class="hl-1">(</span><span class="hl-6">app</span><span class="hl-1">)</span><br/><span class="hl-1">            .</span><span class="hl-0">delete</span><span class="hl-1">(</span><span class="hl-2">`/groups/group/?id=GroupTest2`</span><span class="hl-1">)</span><br/><span class="hl-1">            .</span><span class="hl-0">set</span><span class="hl-1">(</span><span class="hl-2">&#39;Content-Type&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;application/json&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">            .</span><span class="hl-0">end</span><span class="hl-1">((</span><span class="hl-6">err</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">            </span><span class="hl-0">expect</span><span class="hl-1">(</span><span class="hl-6">res</span><span class="hl-1">).</span><span class="hl-6">to</span><span class="hl-1">.</span><span class="hl-6">have</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">);</span><br/><span class="hl-1">            </span><span class="hl-0">done</span><span class="hl-1">();</span><br/><span class="hl-1">            });</span><br/><span class="hl-1">        });</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">});</span><br/><span class="hl-2">````</span><span class="hl-1">	</span><br/><span class="hl-6">Las</span><span class="hl-1"> </span><span class="hl-6">funciones</span><span class="hl-1"> </span><span class="hl-6">del</span><span class="hl-1"> </span><span class="hl-6">controlador</span><span class="hl-1"> </span><span class="hl-10">incluyen</span><span class="hl-1">:</span><br/><br/><span class="hl-1">- </span><span class="hl-10">getGroups</span><span class="hl-1">: </span><span class="hl-6">obtiene</span><span class="hl-1"> </span><span class="hl-6">todos</span><span class="hl-1"> </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">grupos</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">devuelve</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-7">JSON</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">grupos</span><span class="hl-1"> </span><span class="hl-6">encontrados</span><span class="hl-1"> </span><span class="hl-6">o</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">mensaje</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1"> </span><span class="hl-6">si</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">produce</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1">.</span><br/><span class="hl-1">- </span><span class="hl-10">getGroupById</span><span class="hl-1">: </span><span class="hl-6">obtiene</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">grupo</span><span class="hl-1"> </span><span class="hl-6">por</span><span class="hl-1"> </span><span class="hl-7">ID</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">devuelve</span><span class="hl-1"> </span><span class="hl-6">información</span><span class="hl-1"> </span><span class="hl-6">sobre</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">grupo</span><span class="hl-1">, </span><span class="hl-6">como</span><span class="hl-1"> </span><span class="hl-6">las</span><span class="hl-1"> </span><span class="hl-6">rutas</span><span class="hl-1"> </span><span class="hl-6">favoritas</span><span class="hl-1"> </span><span class="hl-6">del</span><span class="hl-1"> </span><span class="hl-6">grupo</span><span class="hl-1">, </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">clasificación</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">usuarios</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">las</span><span class="hl-1"> </span><span class="hl-6">estadísticas</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">historia</span><span class="hl-1"> </span><span class="hl-6">del</span><span class="hl-1"> </span><span class="hl-6">grupo</span><span class="hl-1">. </span><span class="hl-6">El</span><span class="hl-1"> </span><span class="hl-6">controlador</span><span class="hl-1"> </span><span class="hl-6">también</span><span class="hl-1"> </span><span class="hl-6">maneja</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">búsqueda</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">grupos</span><span class="hl-1"> </span><span class="hl-6">por</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">parámetro</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">consulta</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-7">ID</span><span class="hl-1">.</span><br/><span class="hl-1">- </span><span class="hl-10">createGroup</span><span class="hl-1">: </span><span class="hl-6">crea</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">nuevo</span><span class="hl-1"> </span><span class="hl-6">grupo</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1">.</span><br/><span class="hl-1">- </span><span class="hl-10">updateGroup</span><span class="hl-1">: </span><span class="hl-6">actualiza</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">grupo</span><span class="hl-1"> </span><span class="hl-6">existente</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1">.</span><br/><span class="hl-1">- </span><span class="hl-10">deleteGroup</span><span class="hl-1">: </span><span class="hl-6">elimina</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">grupo</span><span class="hl-1"> </span><span class="hl-6">existente</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1">.</span><br/><span class="hl-1">- </span><span class="hl-10">addTrackToHistory</span><span class="hl-1">: </span><span class="hl-6">agrega</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">ruta</span><span class="hl-1"> </span><span class="hl-6">al</span><span class="hl-1"> </span><span class="hl-6">historial</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">grupo</span><span class="hl-1"> </span><span class="hl-6">determinado</span><span class="hl-1">. </span><span class="hl-6">La</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1"> </span><span class="hl-6">toma</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-7">ID</span><span class="hl-1"> </span><span class="hl-6">del</span><span class="hl-1"> </span><span class="hl-6">grupo</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">información</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-0">ruta</span><span class="hl-1"> (</span><span class="hl-6">fecha</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">ruta</span><span class="hl-1">) </span><span class="hl-6">del</span><span class="hl-1"> </span><span class="hl-6">cuerpo</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">solicitud</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">luego</span><span class="hl-1"> </span><span class="hl-6">actualiza</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">historial</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">rutas</span><span class="hl-1"> </span><span class="hl-6">del</span><span class="hl-1"> </span><span class="hl-6">grupo</span><span class="hl-1">.</span><br/><br/><span class="hl-1">#### </span><span class="hl-6">TrackController</span><span class="hl-1">.</span><span class="hl-6">ts</span><span class="hl-1"> &lt;</span><span class="hl-6">a</span><span class="hl-1"> </span><span class="hl-6">name</span><span class="hl-1">=</span><span class="hl-2">&quot;trackController&quot;</span><span class="hl-1">&gt;&lt;/</span><span class="hl-8">a</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-1">&gt; </span><span class="hl-6">El</span><span class="hl-1"> </span><span class="hl-6">controlador</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">rutas</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">encarga</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">manejar</span><span class="hl-1"> </span><span class="hl-6">las</span><span class="hl-1"> </span><span class="hl-6">solicitudes</span><span class="hl-1"> </span><span class="hl-6">relacionadas</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">las</span><span class="hl-1"> </span><span class="hl-6">rutas</span><span class="hl-1">. </span><span class="hl-6">Las</span><span class="hl-1"> </span><span class="hl-6">funciones</span><span class="hl-1"> </span><span class="hl-6">del</span><span class="hl-1"> </span><span class="hl-6">controlador</span><span class="hl-1"> </span><span class="hl-10">incluyen</span><span class="hl-1">:</span><br/><br/><span class="hl-2">````</span><span class="hl-6">typescript</span><span class="hl-1">	</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">Request</span><span class="hl-1">, </span><span class="hl-6">Response</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;express&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">trackModel</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;../models/trackSchema.js&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-3">// Obtener todas las Rutas</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-0">getTracks</span><span class="hl-1"> = </span><span class="hl-4">async</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">: </span><span class="hl-8">Request</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">: </span><span class="hl-8">Response</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">tracks</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">trackModel</span><span class="hl-1">.</span><span class="hl-0">find</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">(</span><span class="hl-6">tracks</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Rutas obtenidas correctamente&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  } </span><span class="hl-5">catch</span><span class="hl-1"> (</span><span class="hl-6">error</span><span class="hl-1"> : </span><span class="hl-8">any</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">500</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1">.</span><span class="hl-6">message</span><span class="hl-1"> });</span><br/><span class="hl-1">    </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Error al obtener las rutas&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-3">// Obtener una Ruta por su ID</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-0">getTrackById</span><span class="hl-1"> = </span><span class="hl-4">async</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">: </span><span class="hl-8">Request</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">: </span><span class="hl-8">Response</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">query</span><span class="hl-1"> = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">query</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-6">query</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">Track</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">trackModel</span><span class="hl-1">.</span><span class="hl-0">findOne</span><span class="hl-1">({ </span><span class="hl-6">id:</span><span class="hl-1"> </span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1"> });</span><br/><span class="hl-1">      </span><span class="hl-5">if</span><span class="hl-1"> (!</span><span class="hl-6">Track</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">404</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Ruta no encontrada&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">(</span><span class="hl-6">Track</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> { </span><span class="hl-7">id</span><span class="hl-1"> } = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">params</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">Track</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">trackModel</span><span class="hl-1">.</span><span class="hl-0">findById</span><span class="hl-1">(</span><span class="hl-6">id</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-5">if</span><span class="hl-1"> (!</span><span class="hl-6">Track</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">404</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Ruta no encontrada&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">(</span><span class="hl-6">Track</span><span class="hl-1">);</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  } </span><span class="hl-5">catch</span><span class="hl-1"> (</span><span class="hl-6">error</span><span class="hl-1"> : </span><span class="hl-8">any</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">500</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1">.</span><span class="hl-6">message</span><span class="hl-1"> });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-3">// Crear una nueva Ruta</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-0">createTrack</span><span class="hl-1"> = </span><span class="hl-4">async</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">: </span><span class="hl-8">Request</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">: </span><span class="hl-8">Response</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">track</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">trackModel</span><span class="hl-1">(</span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">body</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">track</span><span class="hl-1">.</span><span class="hl-0">save</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Ruta creada correctamente&#39;</span><span class="hl-1"> , </span><span class="hl-6">track</span><span class="hl-1"> });</span><br/><span class="hl-1">  } </span><span class="hl-5">catch</span><span class="hl-1"> (</span><span class="hl-6">error</span><span class="hl-1"> : </span><span class="hl-8">any</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">500</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1">.</span><span class="hl-6">message</span><span class="hl-1"> });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-3">// Actualizar una Ruta existente</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-0">updateTrack</span><span class="hl-1"> = </span><span class="hl-4">async</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">: </span><span class="hl-8">Request</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">: </span><span class="hl-8">Response</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">query</span><span class="hl-1"> = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">query</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-6">query</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">Track</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">trackModel</span><span class="hl-1">.</span><span class="hl-0">findOneAndUpdate</span><span class="hl-1">({ </span><span class="hl-6">id:</span><span class="hl-1"> </span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1"> }, </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">body</span><span class="hl-1">, { </span><span class="hl-6">new:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1"> });</span><br/><span class="hl-1">      </span><span class="hl-5">if</span><span class="hl-1"> (!</span><span class="hl-6">Track</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">404</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Ruta no encontrada&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Ruta actualizada correctamente&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> { </span><span class="hl-7">id</span><span class="hl-1"> } = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">params</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">Track</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">trackModel</span><span class="hl-1">.</span><span class="hl-0">findByIdAndUpdate</span><span class="hl-1">(</span><span class="hl-6">id</span><span class="hl-1">, </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">body</span><span class="hl-1">, { </span><span class="hl-6">new:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1"> });</span><br/><span class="hl-1">      </span><span class="hl-5">if</span><span class="hl-1"> (!</span><span class="hl-6">Track</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">404</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Ruta no encontrada&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Ruta actualizada correctamente&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  } </span><span class="hl-5">catch</span><span class="hl-1"> (</span><span class="hl-6">error</span><span class="hl-1"> : </span><span class="hl-8">any</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">500</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1">.</span><span class="hl-6">message</span><span class="hl-1"> });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-3">// Eliminar una Ruta existente</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-0">deleteTrack</span><span class="hl-1"> = </span><span class="hl-4">async</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">: </span><span class="hl-8">Request</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">: </span><span class="hl-8">Response</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">query</span><span class="hl-1"> = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">query</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-6">query</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">Track</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">trackModel</span><span class="hl-1">.</span><span class="hl-0">findOneAndDelete</span><span class="hl-1">({ </span><span class="hl-6">id:</span><span class="hl-1"> </span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1"> });</span><br/><span class="hl-1">      </span><span class="hl-5">if</span><span class="hl-1"> (!</span><span class="hl-6">Track</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">404</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Ruta no encontrada&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Ruta borrada correctamente&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> { </span><span class="hl-7">id</span><span class="hl-1"> } = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">params</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">Track</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">trackModel</span><span class="hl-1">.</span><span class="hl-0">findByIdAndDelete</span><span class="hl-1">(</span><span class="hl-6">id</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-5">if</span><span class="hl-1"> (!</span><span class="hl-6">Track</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">404</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Ruta no encontrada&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Ruta borrada correctamente&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  } </span><span class="hl-5">catch</span><span class="hl-1"> (</span><span class="hl-6">error</span><span class="hl-1"> : </span><span class="hl-8">any</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">500</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1">.</span><span class="hl-6">message</span><span class="hl-1"> });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span><br/><span class="hl-2">````</span><span class="hl-1">	</span><br/><span class="hl-6">Las</span><span class="hl-1"> </span><span class="hl-6">funciones</span><span class="hl-1"> </span><span class="hl-6">del</span><span class="hl-1"> </span><span class="hl-6">controlador</span><span class="hl-1"> </span><span class="hl-10">incluyen</span><span class="hl-1">:</span><br/><br/><span class="hl-1">- </span><span class="hl-6">La</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1"> </span><span class="hl-6">getTracks</span><span class="hl-1"> </span><span class="hl-6">maneja</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">operación</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">Leer</span><span class="hl-1"> </span><span class="hl-6">todos</span><span class="hl-1"> </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">registros</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">entidad</span><span class="hl-1"> </span><span class="hl-2">&quot;ruta&quot;</span><span class="hl-1">. </span><span class="hl-6">Primero</span><span class="hl-1">, </span><span class="hl-6">usa</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">modelo</span><span class="hl-1"> </span><span class="hl-6">trackModel</span><span class="hl-1"> </span><span class="hl-6">para</span><span class="hl-1"> </span><span class="hl-6">obtener</span><span class="hl-1"> </span><span class="hl-6">todos</span><span class="hl-1"> </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">registros</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1"> </span><span class="hl-6">usando</span><span class="hl-1"> </span><span class="hl-0">find</span><span class="hl-1">(). </span><span class="hl-6">Luego</span><span class="hl-1">, </span><span class="hl-6">envía</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">respuesta</span><span class="hl-1"> </span><span class="hl-7">JSON</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">registros</span><span class="hl-1"> </span><span class="hl-6">obtenidos</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">código</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">estado</span><span class="hl-1"> </span><span class="hl-7">HTTP</span><span class="hl-1"> </span><span class="hl-9">200</span><span class="hl-1"> (</span><span class="hl-7">OK</span><span class="hl-1">). </span><span class="hl-6">Si</span><span class="hl-1"> </span><span class="hl-6">hay</span><span class="hl-1"> </span><span class="hl-6">algún</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1"> </span><span class="hl-6">durante</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">operación</span><span class="hl-1">, </span><span class="hl-6">envía</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">respuesta</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">mensaje</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">código</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">estado</span><span class="hl-1"> </span><span class="hl-7">HTTP</span><span class="hl-1"> </span><span class="hl-9">500</span><span class="hl-1"> (</span><span class="hl-6">Error</span><span class="hl-1"> </span><span class="hl-6">interno</span><span class="hl-1"> </span><span class="hl-6">del</span><span class="hl-1"> </span><span class="hl-6">servidor</span><span class="hl-1">).</span><br/><span class="hl-1">- </span><span class="hl-6">La</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1"> </span><span class="hl-6">getTrackById</span><span class="hl-1"> </span><span class="hl-6">maneja</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">operación</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">Leer</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">registro</span><span class="hl-1"> </span><span class="hl-6">específico</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">entidad</span><span class="hl-1"> </span><span class="hl-2">&quot;ruta&quot;</span><span class="hl-1"> </span><span class="hl-6">por</span><span class="hl-1"> </span><span class="hl-6">su</span><span class="hl-1"> </span><span class="hl-7">ID</span><span class="hl-1">. </span><span class="hl-6">Primero</span><span class="hl-1">, </span><span class="hl-6">revisa</span><span class="hl-1"> </span><span class="hl-6">si</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-7">ID</span><span class="hl-1"> </span><span class="hl-6">es</span><span class="hl-1"> </span><span class="hl-6">proporcionado</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">consulta</span><span class="hl-1">. </span><span class="hl-6">Si</span><span class="hl-1"> </span><span class="hl-6">es</span><span class="hl-1"> </span><span class="hl-6">así</span><span class="hl-1">, </span><span class="hl-6">utiliza</span><span class="hl-1"> </span><span class="hl-0">findOne</span><span class="hl-1">() </span><span class="hl-6">para</span><span class="hl-1"> </span><span class="hl-6">buscar</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">registro</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">envía</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">respuesta</span><span class="hl-1"> </span><span class="hl-7">JSON</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">registro</span><span class="hl-1"> </span><span class="hl-6">encontrado</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">código</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">estado</span><span class="hl-1"> </span><span class="hl-7">HTTP</span><span class="hl-1"> </span><span class="hl-9">200</span><span class="hl-1"> (</span><span class="hl-7">OK</span><span class="hl-1">). </span><span class="hl-6">Si</span><span class="hl-1"> </span><span class="hl-6">no</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">encuentra</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">registro</span><span class="hl-1">, </span><span class="hl-6">envía</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">respuesta</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">mensaje</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">código</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">estado</span><span class="hl-1"> </span><span class="hl-7">HTTP</span><span class="hl-1"> </span><span class="hl-9">404</span><span class="hl-1"> (</span><span class="hl-6">No</span><span class="hl-1"> </span><span class="hl-6">encontrado</span><span class="hl-1">). </span><span class="hl-6">Si</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-7">ID</span><span class="hl-1"> </span><span class="hl-6">no</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">proporciona</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">consulta</span><span class="hl-1">, </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1"> </span><span class="hl-6">utiliza</span><span class="hl-1"> </span><span class="hl-0">findById</span><span class="hl-1">() </span><span class="hl-6">para</span><span class="hl-1"> </span><span class="hl-6">buscar</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">registro</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1"> </span><span class="hl-6">utilizando</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-7">ID</span><span class="hl-1"> </span><span class="hl-6">proporcionado</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">parámetros</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">solicitud</span><span class="hl-1">.</span><br/><span class="hl-1">- </span><span class="hl-6">La</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1"> </span><span class="hl-6">createTrack</span><span class="hl-1"> </span><span class="hl-6">maneja</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">operación</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">Crear</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">nuevo</span><span class="hl-1"> </span><span class="hl-6">registro</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">entidad</span><span class="hl-1"> </span><span class="hl-2">&quot;ruta&quot;</span><span class="hl-1">. </span><span class="hl-6">Crea</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">nuevo</span><span class="hl-1"> </span><span class="hl-6">objeto</span><span class="hl-1"> </span><span class="hl-6">track</span><span class="hl-1"> </span><span class="hl-6">utilizando</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">modelo</span><span class="hl-1"> </span><span class="hl-6">trackModel</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">lo</span><span class="hl-1"> </span><span class="hl-6">guarda</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1"> </span><span class="hl-6">usando</span><span class="hl-1"> </span><span class="hl-0">save</span><span class="hl-1">(). </span><span class="hl-6">Luego</span><span class="hl-1">, </span><span class="hl-6">envía</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">respuesta</span><span class="hl-1"> </span><span class="hl-7">JSON</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">mensaje</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">éxito</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">objeto</span><span class="hl-1"> </span><span class="hl-6">track</span><span class="hl-1"> </span><span class="hl-6">creado</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">código</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">estado</span><span class="hl-1"> </span><span class="hl-7">HTTP</span><span class="hl-1"> </span><span class="hl-9">200</span><span class="hl-1"> (</span><span class="hl-7">OK</span><span class="hl-1">). </span><span class="hl-6">Si</span><span class="hl-1"> </span><span class="hl-6">hay</span><span class="hl-1"> </span><span class="hl-6">algún</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1"> </span><span class="hl-6">durante</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">operación</span><span class="hl-1">, </span><span class="hl-6">envía</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">respuesta</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">mensaje</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">código</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">estado</span><span class="hl-1"> </span><span class="hl-7">HTTP</span><span class="hl-1"> </span><span class="hl-9">500</span><span class="hl-1"> (</span><span class="hl-6">Error</span><span class="hl-1"> </span><span class="hl-6">interno</span><span class="hl-1"> </span><span class="hl-6">del</span><span class="hl-1"> </span><span class="hl-6">servidor</span><span class="hl-1">).</span><br/><span class="hl-1">- </span><span class="hl-6">La</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1"> </span><span class="hl-6">updateTrack</span><span class="hl-1"> </span><span class="hl-6">maneja</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">operación</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">Actualizar</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">registro</span><span class="hl-1"> </span><span class="hl-6">existente</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">entidad</span><span class="hl-1"> </span><span class="hl-2">&quot;ruta&quot;</span><span class="hl-1">. </span><span class="hl-6">Revisa</span><span class="hl-1"> </span><span class="hl-6">si</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-7">ID</span><span class="hl-1"> </span><span class="hl-6">es</span><span class="hl-1"> </span><span class="hl-6">proporcionado</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">consulta</span><span class="hl-1"> </span><span class="hl-6">o</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">parámetros</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">solicitud</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">utiliza</span><span class="hl-1"> </span><span class="hl-0">findOneAndUpdate</span><span class="hl-1">() </span><span class="hl-6">o</span><span class="hl-1"> </span><span class="hl-0">findByIdAndUpdate</span><span class="hl-1">() </span><span class="hl-6">para</span><span class="hl-1"> </span><span class="hl-6">actualizar</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">registro</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1">. </span><span class="hl-6">Si</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">registro</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">actualiza</span><span class="hl-1"> </span><span class="hl-6">correctamente</span><span class="hl-1">, </span><span class="hl-6">envía</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">respuesta</span><span class="hl-1"> </span><span class="hl-7">JSON</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">mensaje</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">éxito</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">código</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">estado</span><span class="hl-1"> </span><span class="hl-7">HTTP</span><span class="hl-1"> </span><span class="hl-9">200</span><span class="hl-1"> (</span><span class="hl-7">OK</span><span class="hl-1">). </span><span class="hl-6">Si</span><span class="hl-1"> </span><span class="hl-6">no</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">encuentra</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">registro</span><span class="hl-1">, </span><span class="hl-6">envía</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">respuesta</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">mensaje</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">código</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">estado</span><span class="hl-1"> </span><span class="hl-7">HTTP</span><span class="hl-1"> </span><span class="hl-9">404</span><span class="hl-1"> (</span><span class="hl-6">No</span><span class="hl-1"> </span><span class="hl-6">encontrado</span><span class="hl-1">).</span><br/><span class="hl-1">- </span><span class="hl-6">La</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1"> </span><span class="hl-6">deleteTrack</span><span class="hl-1"> </span><span class="hl-6">maneja</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">operación</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">Borrar</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">registro</span><span class="hl-1"> </span><span class="hl-6">existente</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">entidad</span><span class="hl-1"> </span><span class="hl-2">&quot;ruta&quot;</span><span class="hl-1">. </span><span class="hl-6">Revisa</span><span class="hl-1"> </span><span class="hl-6">si</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-7">ID</span><span class="hl-1"> </span><span class="hl-6">es</span><span class="hl-1"> </span><span class="hl-6">proporcionado</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">consulta</span><span class="hl-1"> </span><span class="hl-6">o</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">parámetros</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">solicitud</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">utiliza</span><span class="hl-1"> </span><span class="hl-0">findOneAndDelete</span><span class="hl-1">() </span><span class="hl-6">o</span><span class="hl-1"> </span><span class="hl-0">findByIdAndDelete</span><span class="hl-1">() </span><span class="hl-6">para</span><span class="hl-1"> </span><span class="hl-6">eliminar</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">registro</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1">. </span><span class="hl-6">Si</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">registro</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">elimina</span><span class="hl-1"> </span><span class="hl-6">correctamente</span><span class="hl-1">, </span><span class="hl-6">envía</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">respuesta</span><span class="hl-1"> </span><span class="hl-7">JSON</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">mensaje</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">éxito</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">código</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">estado</span><span class="hl-1"> </span><span class="hl-7">HTTP</span><span class="hl-1"> </span><span class="hl-9">200</span><span class="hl-1"> (</span><span class="hl-7">OK</span><span class="hl-1">). </span><span class="hl-6">Si</span><span class="hl-1"> </span><span class="hl-6">no</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">encuentra</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">registro</span><span class="hl-1">, </span><span class="hl-6">envía</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">respuesta</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">mensaje</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">código</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">estado</span><span class="hl-1"> </span><span class="hl-7">HTTP</span><span class="hl-1"> </span><span class="hl-9">404</span><span class="hl-1"> (</span><span class="hl-6">No</span><span class="hl-1"> </span><span class="hl-6">encontrado</span><span class="hl-1">).</span><br/><br/><span class="hl-1">#### </span><span class="hl-6">UserController</span><span class="hl-1">.</span><span class="hl-6">ts</span><span class="hl-1"> &lt;</span><span class="hl-6">a</span><span class="hl-1"> </span><span class="hl-6">name</span><span class="hl-1">=</span><span class="hl-2">&quot;userController&quot;</span><span class="hl-1">&gt;&lt;/</span><span class="hl-8">a</span><span class="hl-1">&gt;</span><br/><br/><span class="hl-1">&gt; </span><span class="hl-6">El</span><span class="hl-1"> </span><span class="hl-6">controlador</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">usuario</span><span class="hl-1"> </span><span class="hl-6">contiene</span><span class="hl-1"> </span><span class="hl-6">las</span><span class="hl-1"> </span><span class="hl-6">funciones</span><span class="hl-1"> </span><span class="hl-6">que</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">encargan</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">manejar</span><span class="hl-1"> </span><span class="hl-6">las</span><span class="hl-1"> </span><span class="hl-6">peticiones</span><span class="hl-1"> </span><span class="hl-6">que</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">realizan</span><span class="hl-1"> </span><span class="hl-6">a</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">entidad</span><span class="hl-1"> </span><span class="hl-6">usuario</span><span class="hl-1">.</span><br/><br/><span class="hl-2">````</span><span class="hl-6">typescript</span><span class="hl-1">	</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">Request</span><span class="hl-1">, </span><span class="hl-6">Response</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;express&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">userModel</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;../models/userSchema.js&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">challengeModel</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;../models/challengeSchema.js&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">groupModel</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;../models/groupSchema.js&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">historyFunction</span><span class="hl-1">, </span><span class="hl-6">favoriteRoutes</span><span class="hl-1">, </span><span class="hl-6">activeChallenges</span><span class="hl-1">, </span><span class="hl-6">getGroupForUser</span><span class="hl-1">} </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;../utils/functions.js&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> </span><span class="hl-6">mongoose</span><span class="hl-1"> </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;mongoose&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-3">// Obtener todos los usuarios</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-0">getUsers</span><span class="hl-1"> = </span><span class="hl-4">async</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">: </span><span class="hl-8">Request</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">: </span><span class="hl-8">Response</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">try</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">users</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">userModel</span><span class="hl-1">.</span><span class="hl-0">find</span><span class="hl-1">().</span><span class="hl-0">populate</span><span class="hl-1">(</span><span class="hl-2">&#39;friends&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;name&#39;</span><span class="hl-1">).</span><span class="hl-0">populate</span><span class="hl-1">(</span><span class="hl-2">&#39;historicTracks&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;name&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">(</span><span class="hl-6">users</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Usuarios obtenidos correctamente&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    } </span><span class="hl-5">catch</span><span class="hl-1"> (</span><span class="hl-6">error</span><span class="hl-1"> : </span><span class="hl-8">any</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">500</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1">.</span><span class="hl-6">message</span><span class="hl-1"> });</span><br/><span class="hl-1">    </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Error al obtener los usuarios&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-3">// Obtener un usuario por su ID o por nombre</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-0">getUserById</span><span class="hl-1"> = </span><span class="hl-4">async</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">: </span><span class="hl-8">Request</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">: </span><span class="hl-8">Response</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">query</span><span class="hl-1"> = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">query</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-6">query</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">user</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">userModel</span><span class="hl-1">.</span><span class="hl-0">findOne</span><span class="hl-1">({ </span><span class="hl-6">id:</span><span class="hl-1"> </span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1"> }).</span><span class="hl-0">populate</span><span class="hl-1">(</span><span class="hl-2">&#39;friends&#39;</span><span class="hl-1">,[</span><span class="hl-2">&#39;id&#39;</span><span class="hl-1">,</span><span class="hl-2">&#39;name&#39;</span><span class="hl-1">]).</span><span class="hl-0">populate</span><span class="hl-1">(</span><span class="hl-2">&#39;historicTracks.track&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-5">if</span><span class="hl-1"> (!</span><span class="hl-6">user</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">404</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Usuario no encontrado&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">Groups</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">groupModel</span><span class="hl-1">.</span><span class="hl-0">find</span><span class="hl-1">().</span><span class="hl-0">populate</span><span class="hl-1">(</span><span class="hl-2">&#39;participants.user&#39;</span><span class="hl-1">, [</span><span class="hl-2">&#39;id&#39;</span><span class="hl-1">,</span><span class="hl-2">&#39;name&#39;</span><span class="hl-1">])</span><br/><span class="hl-1">        </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">activeGroups</span><span class="hl-1"> = </span><span class="hl-0">getGroupForUser</span><span class="hl-1">(</span><span class="hl-6">Groups</span><span class="hl-1">, </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">)</span><br/><span class="hl-1">        </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">stats</span><span class="hl-1"> = </span><span class="hl-0">historyFunction</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">historicTracks</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">favTracks</span><span class="hl-1"> = </span><span class="hl-0">favoriteRoutes</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">historicTracks</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">challenges</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">challengeModel</span><span class="hl-1">.</span><span class="hl-0">find</span><span class="hl-1">();</span><br/><span class="hl-1">        </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">activChallenges</span><span class="hl-1"> = </span><span class="hl-0">activeChallenges</span><span class="hl-1">(</span><span class="hl-6">challenges</span><span class="hl-1">, </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">_id</span><span class="hl-1">.</span><span class="hl-0">toString</span><span class="hl-1">());</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({</span><span class="hl-6">user:</span><span class="hl-1"> </span><span class="hl-6">user</span><span class="hl-1">, </span><span class="hl-6">activeGroups</span><span class="hl-1">, </span><span class="hl-6">stats:</span><span class="hl-1">{</span><span class="hl-2">&quot;km semanales&quot;</span><span class="hl-6">:</span><span class="hl-1"> </span><span class="hl-6">stats</span><span class="hl-1">[</span><span class="hl-9">0</span><span class="hl-1">],</span><span class="hl-2">&quot;Desnivel semanal&quot;</span><span class="hl-6">:</span><span class="hl-1"> </span><span class="hl-6">stats</span><span class="hl-1">[</span><span class="hl-9">1</span><span class="hl-1">], </span><span class="hl-2">&quot;km mensuales&quot;</span><span class="hl-6">:</span><span class="hl-1"> </span><span class="hl-6">stats</span><span class="hl-1">[</span><span class="hl-9">2</span><span class="hl-1">],</span><span class="hl-2">&quot;Desnivel mensual&quot;</span><span class="hl-6">:</span><span class="hl-1"> </span><span class="hl-6">stats</span><span class="hl-1">[</span><span class="hl-9">3</span><span class="hl-1">], </span><span class="hl-2">&quot;km anuales&quot;</span><span class="hl-6">:</span><span class="hl-1"> </span><span class="hl-6">stats</span><span class="hl-1">[</span><span class="hl-9">4</span><span class="hl-1">], </span><span class="hl-2">&quot;Desnivel anual&quot;</span><span class="hl-6">:</span><span class="hl-1"> </span><span class="hl-6">stats</span><span class="hl-1">[</span><span class="hl-9">5</span><span class="hl-1">]}, </span><span class="hl-6">favTracks</span><span class="hl-1">, </span><span class="hl-6">activChallenges</span><span class="hl-1">});</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> { </span><span class="hl-7">id</span><span class="hl-1"> } = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">params</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">user</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">userModel</span><span class="hl-1">.</span><span class="hl-0">findById</span><span class="hl-1">(</span><span class="hl-6">id</span><span class="hl-1">).</span><span class="hl-0">populate</span><span class="hl-1">(</span><span class="hl-2">&#39;friends&#39;</span><span class="hl-1">, </span><span class="hl-2">&#39;name&#39;</span><span class="hl-1">).</span><span class="hl-0">populate</span><span class="hl-1">(</span><span class="hl-2">&#39;historicTracks.track&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-5">if</span><span class="hl-1"> (!</span><span class="hl-6">user</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">404</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Usuario no encontrado&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">stats</span><span class="hl-1"> = </span><span class="hl-0">historyFunction</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">historicTracks</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">favTracks</span><span class="hl-1"> = </span><span class="hl-0">favoriteRoutes</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">historicTracks</span><span class="hl-1">);</span><br/><span class="hl-1">        </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">challenges</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">challengeModel</span><span class="hl-1">.</span><span class="hl-0">find</span><span class="hl-1">();</span><br/><span class="hl-1">        </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">activChallenges</span><span class="hl-1"> = </span><span class="hl-0">activeChallenges</span><span class="hl-1">(</span><span class="hl-6">challenges</span><span class="hl-1">, </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-6">_id</span><span class="hl-1">.</span><span class="hl-0">toString</span><span class="hl-1">());</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({</span><span class="hl-6">user:</span><span class="hl-1"> </span><span class="hl-6">user</span><span class="hl-1">, </span><span class="hl-6">stats:</span><span class="hl-1">{</span><span class="hl-2">&quot;km semanales&quot;</span><span class="hl-6">:</span><span class="hl-1"> </span><span class="hl-6">stats</span><span class="hl-1">[</span><span class="hl-9">0</span><span class="hl-1">],</span><span class="hl-2">&quot;Desnivel semanal&quot;</span><span class="hl-6">:</span><span class="hl-1"> </span><span class="hl-6">stats</span><span class="hl-1">[</span><span class="hl-9">1</span><span class="hl-1">], </span><span class="hl-2">&quot;km mensuales&quot;</span><span class="hl-6">:</span><span class="hl-1"> </span><span class="hl-6">stats</span><span class="hl-1">[</span><span class="hl-9">2</span><span class="hl-1">],</span><span class="hl-2">&quot;Desnivel mensual&quot;</span><span class="hl-6">:</span><span class="hl-1"> </span><span class="hl-6">stats</span><span class="hl-1">[</span><span class="hl-9">3</span><span class="hl-1">], </span><span class="hl-2">&quot;km anuales&quot;</span><span class="hl-6">:</span><span class="hl-1"> </span><span class="hl-6">stats</span><span class="hl-1">[</span><span class="hl-9">4</span><span class="hl-1">], </span><span class="hl-2">&quot;Desnivel anual&quot;</span><span class="hl-6">:</span><span class="hl-1"> </span><span class="hl-6">stats</span><span class="hl-1">[</span><span class="hl-9">5</span><span class="hl-1">]}, </span><span class="hl-6">favTracks</span><span class="hl-1">, </span><span class="hl-6">activChallenges</span><span class="hl-1">});</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  } </span><span class="hl-5">catch</span><span class="hl-1"> (</span><span class="hl-6">error</span><span class="hl-1"> : </span><span class="hl-8">any</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">500</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1">.</span><span class="hl-6">message</span><span class="hl-1"> });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-3">// Crear un nuevo usuario</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-0">createUser</span><span class="hl-1"> = </span><span class="hl-4">async</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">: </span><span class="hl-8">Request</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">: </span><span class="hl-8">Response</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">user</span><span class="hl-1"> = </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">userModel</span><span class="hl-1">(</span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">body</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">user</span><span class="hl-1">.</span><span class="hl-0">save</span><span class="hl-1">();</span><br/><span class="hl-1">    </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Usuario creado correctamente&#39;</span><span class="hl-1">, </span><span class="hl-6">user</span><span class="hl-1"> });</span><br/><span class="hl-1">  } </span><span class="hl-5">catch</span><span class="hl-1"> (</span><span class="hl-6">error</span><span class="hl-1"> : </span><span class="hl-8">any</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">500</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1">.</span><span class="hl-6">message</span><span class="hl-1"> });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-3">// Actualizar un usuario existente</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-0">updateUser</span><span class="hl-1"> = </span><span class="hl-4">async</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">: </span><span class="hl-8">Request</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">: </span><span class="hl-8">Response</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">query</span><span class="hl-1"> = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">query</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-6">query</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">user</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">userModel</span><span class="hl-1">.</span><span class="hl-0">findOneAndUpdate</span><span class="hl-1">({ </span><span class="hl-6">id:</span><span class="hl-1"> </span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1"> }, </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">body</span><span class="hl-1">, { </span><span class="hl-6">new:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1"> });</span><br/><span class="hl-1">      </span><span class="hl-5">if</span><span class="hl-1"> (!</span><span class="hl-6">user</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">404</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Usuario no encontrado&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Usuario actualizado correctamente&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> { </span><span class="hl-7">id</span><span class="hl-1"> } = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">params</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">user</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">userModel</span><span class="hl-1">.</span><span class="hl-0">findByIdAndUpdate</span><span class="hl-1">(</span><span class="hl-6">id</span><span class="hl-1">, </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">body</span><span class="hl-1">, { </span><span class="hl-6">new:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1"> });</span><br/><span class="hl-1">      </span><span class="hl-5">if</span><span class="hl-1"> (!</span><span class="hl-6">user</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">404</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Usuario no encontrado&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Usuario actualizado correctamente&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  } </span><span class="hl-5">catch</span><span class="hl-1"> (</span><span class="hl-6">error</span><span class="hl-1"> : </span><span class="hl-8">any</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">500</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1">.</span><span class="hl-6">message</span><span class="hl-1"> });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-3">// Eliminar un usuario existente</span><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-0">deleteUser</span><span class="hl-1"> = </span><span class="hl-4">async</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">: </span><span class="hl-8">Request</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">: </span><span class="hl-8">Response</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">query</span><span class="hl-1"> = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">query</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-5">if</span><span class="hl-1"> (</span><span class="hl-6">query</span><span class="hl-1"> &amp;&amp; </span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">user</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">userModel</span><span class="hl-1">.</span><span class="hl-0">findOneAndDelete</span><span class="hl-1">({ </span><span class="hl-6">id:</span><span class="hl-1"> </span><span class="hl-6">query</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1"> });</span><br/><span class="hl-1">      </span><span class="hl-5">if</span><span class="hl-1"> (!</span><span class="hl-6">user</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">404</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Usuario no encontrado&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Usuario borrado correctamente&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> { </span><span class="hl-7">id</span><span class="hl-1"> } = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">params</span><span class="hl-1">;</span><br/><span class="hl-1">      </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">user</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">userModel</span><span class="hl-1">.</span><span class="hl-0">findByIdAndDelete</span><span class="hl-1">(</span><span class="hl-6">id</span><span class="hl-1">);</span><br/><span class="hl-1">      </span><span class="hl-5">if</span><span class="hl-1"> (!</span><span class="hl-6">user</span><span class="hl-1">) {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">404</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Usuario no encontrado&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      } </span><span class="hl-5">else</span><span class="hl-1"> {</span><br/><span class="hl-1">        </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">200</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-2">&#39;Usuario borrado correctamente&#39;</span><span class="hl-1"> });</span><br/><span class="hl-1">      }</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  } </span><span class="hl-5">catch</span><span class="hl-1"> (</span><span class="hl-6">error</span><span class="hl-1"> : </span><span class="hl-8">any</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">500</span><span class="hl-1">).</span><span class="hl-0">json</span><span class="hl-1">({ </span><span class="hl-6">message:</span><span class="hl-1"> </span><span class="hl-6">error</span><span class="hl-1">.</span><span class="hl-6">message</span><span class="hl-1"> });</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span><br/><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-0">addTrackToHistory</span><span class="hl-1"> = </span><span class="hl-4">async</span><span class="hl-1"> (</span><span class="hl-6">req</span><span class="hl-1">: </span><span class="hl-8">Request</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">: </span><span class="hl-8">Response</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-5">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">userId</span><span class="hl-1"> = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">params</span><span class="hl-1">.</span><span class="hl-6">id</span><span class="hl-1">;</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> { </span><span class="hl-7">date</span><span class="hl-1">, </span><span class="hl-7">track</span><span class="hl-1"> } = </span><span class="hl-6">req</span><span class="hl-1">.</span><span class="hl-6">body</span><span class="hl-1">; </span><span class="hl-3">// Asegúrate de que el cuerpo de la petición incluye la fecha y el ID de la ruta</span><br/><span class="hl-1">    </span><span class="hl-3">// Encuentra el usuario y actualiza su array historicTracks</span><br/><span class="hl-1">    </span><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">user</span><span class="hl-1"> = </span><span class="hl-5">await</span><span class="hl-1"> </span><span class="hl-6">userModel</span><span class="hl-1">.</span><span class="hl-0">findByIdAndUpdate</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-6">userId</span><span class="hl-1">, </span><br/><span class="hl-1">      { </span><span class="hl-6">$push:</span><span class="hl-1"> { </span><span class="hl-6">historicTracks:</span><span class="hl-1"> { </span><span class="hl-6">date:</span><span class="hl-1"> </span><span class="hl-4">new</span><span class="hl-1"> </span><span class="hl-0">Date</span><span class="hl-1">(</span><span class="hl-6">date</span><span class="hl-1">), </span><span class="hl-6">track:</span><span class="hl-1"> </span><span class="hl-6">track</span><span class="hl-1"> } } }, </span><br/><span class="hl-1">      { </span><span class="hl-6">new:</span><span class="hl-1"> </span><span class="hl-4">true</span><span class="hl-1">, </span><span class="hl-6">useFindAndModify:</span><span class="hl-1"> </span><span class="hl-4">false</span><span class="hl-1"> } </span><span class="hl-3">// new: true para devolver el documento actualizado, useFindAndModify: false para utilizar el método findOneAndUpdate de Mongoose en lugar del método findAndModify de MongoDB</span><br/><span class="hl-1">    );</span><br/><br/><span class="hl-1">    </span><span class="hl-5">if</span><span class="hl-1"> (!</span><span class="hl-6">user</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">404</span><span class="hl-1">).</span><span class="hl-0">send</span><span class="hl-1">(</span><span class="hl-2">&#39;User not found&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><br/><span class="hl-1">    </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">(</span><span class="hl-6">user</span><span class="hl-1">);</span><br/><br/><span class="hl-1">  } </span><span class="hl-5">catch</span><span class="hl-1"> (</span><span class="hl-6">error</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-5">return</span><span class="hl-1"> </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">status</span><span class="hl-1">(</span><span class="hl-9">500</span><span class="hl-1">).</span><span class="hl-0">send</span><span class="hl-1">(</span><span class="hl-2">&#39;Server error&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">};</span><br/><span class="hl-2">````</span><span class="hl-1">	</span><br/><br/><span class="hl-6">Las</span><span class="hl-1"> </span><span class="hl-6">funciones</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">controlador</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">usuario</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">definen</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">siguiente</span><span class="hl-1"> </span><span class="hl-10">manera</span><span class="hl-1">:</span><br/><br/><span class="hl-1">- </span><span class="hl-10">getUsers</span><span class="hl-1">: </span><span class="hl-6">Esta</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1"> </span><span class="hl-6">maneja</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">solicitud</span><span class="hl-1"> </span><span class="hl-7">GET</span><span class="hl-1"> </span><span class="hl-6">a</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">ruta</span><span class="hl-1"> </span><span class="hl-2">&quot;/users&quot;</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">devuelve</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">lista</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">todos</span><span class="hl-1"> </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">usuarios</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1">. </span><span class="hl-6">Se</span><span class="hl-1"> </span><span class="hl-6">utiliza</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">método</span><span class="hl-1"> </span><span class="hl-0">find</span><span class="hl-1">() </span><span class="hl-6">del</span><span class="hl-1"> </span><span class="hl-6">modelo</span><span class="hl-1"> </span><span class="hl-6">userModel</span><span class="hl-1"> </span><span class="hl-6">para</span><span class="hl-1"> </span><span class="hl-6">obtener</span><span class="hl-1"> </span><span class="hl-6">todos</span><span class="hl-1"> </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">usuarios</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">utiliza</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">método</span><span class="hl-1"> </span><span class="hl-0">populate</span><span class="hl-1">() </span><span class="hl-6">para</span><span class="hl-1"> </span><span class="hl-6">incluir</span><span class="hl-1"> </span><span class="hl-6">información</span><span class="hl-1"> </span><span class="hl-6">adicional</span><span class="hl-1"> </span><span class="hl-6">sobre</span><span class="hl-1"> </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">usuarios</span><span class="hl-1">, </span><span class="hl-6">como</span><span class="hl-1"> </span><span class="hl-6">sus</span><span class="hl-1"> </span><span class="hl-6">amigos</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">las</span><span class="hl-1"> </span><span class="hl-6">rutas</span><span class="hl-1"> </span><span class="hl-6">que</span><span class="hl-1"> </span><span class="hl-6">han</span><span class="hl-1"> </span><span class="hl-6">completado</span><span class="hl-1">. </span><span class="hl-6">Si</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">solicitud</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">realiza</span><span class="hl-1"> </span><span class="hl-6">correctamente</span><span class="hl-1">, </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1"> </span><span class="hl-6">devuelve</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">objeto</span><span class="hl-1"> </span><span class="hl-7">JSON</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">clave</span><span class="hl-1"> </span><span class="hl-2">&quot;usuarios&quot;</span><span class="hl-1"> </span><span class="hl-6">que</span><span class="hl-1"> </span><span class="hl-6">contiene</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">lista</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">usuarios</span><span class="hl-1">.</span><br/><span class="hl-1">- </span><span class="hl-10">getUserById</span><span class="hl-1">: </span><span class="hl-6">Esta</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1"> </span><span class="hl-6">maneja</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">solicitud</span><span class="hl-1"> </span><span class="hl-7">GET</span><span class="hl-1"> </span><span class="hl-6">a</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">ruta</span><span class="hl-1"> </span><span class="hl-2">&quot;/users/:id&quot;</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">devuelve</span><span class="hl-1"> </span><span class="hl-6">información</span><span class="hl-1"> </span><span class="hl-6">detallada</span><span class="hl-1"> </span><span class="hl-6">sobre</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">usuario</span><span class="hl-1"> </span><span class="hl-6">específico</span><span class="hl-1">. </span><span class="hl-6">Si</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">parámetro</span><span class="hl-1"> </span><span class="hl-6">id</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">proporciona</span><span class="hl-1"> </span><span class="hl-6">como</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">consulta</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">solicitud</span><span class="hl-1">, </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">utiliza</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">método</span><span class="hl-1"> </span><span class="hl-0">findOne</span><span class="hl-1">() </span><span class="hl-6">del</span><span class="hl-1"> </span><span class="hl-6">modelo</span><span class="hl-1"> </span><span class="hl-6">userModel</span><span class="hl-1"> </span><span class="hl-6">para</span><span class="hl-1"> </span><span class="hl-6">buscar</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">usuario</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-7">ID</span><span class="hl-1"> </span><span class="hl-6">especificado</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">utiliza</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">método</span><span class="hl-1"> </span><span class="hl-0">populate</span><span class="hl-1">() </span><span class="hl-6">para</span><span class="hl-1"> </span><span class="hl-6">incluir</span><span class="hl-1"> </span><span class="hl-6">información</span><span class="hl-1"> </span><span class="hl-6">adicional</span><span class="hl-1"> </span><span class="hl-6">sobre</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">usuario</span><span class="hl-1">. </span><span class="hl-6">Si</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">parámetro</span><span class="hl-1"> </span><span class="hl-6">id</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">proporciona</span><span class="hl-1"> </span><span class="hl-6">como</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">parte</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">ruta</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">solicitud</span><span class="hl-1">, </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">utiliza</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">método</span><span class="hl-1"> </span><span class="hl-0">findById</span><span class="hl-1">() </span><span class="hl-6">del</span><span class="hl-1"> </span><span class="hl-6">modelo</span><span class="hl-1"> </span><span class="hl-6">userModel</span><span class="hl-1"> </span><span class="hl-6">para</span><span class="hl-1"> </span><span class="hl-6">buscar</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">usuario</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-7">ID</span><span class="hl-1"> </span><span class="hl-6">especificado</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">utiliza</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">método</span><span class="hl-1"> </span><span class="hl-0">populate</span><span class="hl-1">() </span><span class="hl-6">para</span><span class="hl-1"> </span><span class="hl-6">incluir</span><span class="hl-1"> </span><span class="hl-6">información</span><span class="hl-1"> </span><span class="hl-6">adicional</span><span class="hl-1"> </span><span class="hl-6">sobre</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">usuario</span><span class="hl-1">. </span><span class="hl-6">La</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1"> </span><span class="hl-6">devuelve</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">objeto</span><span class="hl-1"> </span><span class="hl-7">JSON</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">información</span><span class="hl-1"> </span><span class="hl-6">detallada</span><span class="hl-1"> </span><span class="hl-6">sobre</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">usuario</span><span class="hl-1">, </span><span class="hl-6">incluyendo</span><span class="hl-1"> </span><span class="hl-6">estadísticas</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">historial</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">rutas</span><span class="hl-1">, </span><span class="hl-6">rutas</span><span class="hl-1"> </span><span class="hl-6">favoritas</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">desafíos</span><span class="hl-1"> </span><span class="hl-6">activos</span><span class="hl-1">.</span><br/><span class="hl-1">- </span><span class="hl-10">createUser</span><span class="hl-1">: </span><span class="hl-6">Esta</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1"> </span><span class="hl-6">maneja</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">solicitud</span><span class="hl-1"> </span><span class="hl-7">POST</span><span class="hl-1"> </span><span class="hl-6">a</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">ruta</span><span class="hl-1"> </span><span class="hl-2">&quot;/users&quot;</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">crea</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">nuevo</span><span class="hl-1"> </span><span class="hl-6">usuario</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1"> </span><span class="hl-6">utilizando</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">modelo</span><span class="hl-1"> </span><span class="hl-6">userModel</span><span class="hl-1">. </span><span class="hl-6">Si</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">creación</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">usuario</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">realiza</span><span class="hl-1"> </span><span class="hl-6">correctamente</span><span class="hl-1">, </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1"> </span><span class="hl-6">devuelve</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">objeto</span><span class="hl-1"> </span><span class="hl-7">JSON</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">mensaje</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">confirmación</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">usuario</span><span class="hl-1"> </span><span class="hl-6">creado</span><span class="hl-1">.</span><br/><span class="hl-1">- </span><span class="hl-10">updateUser</span><span class="hl-1">: </span><span class="hl-6">Esta</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1"> </span><span class="hl-6">maneja</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">solicitud</span><span class="hl-1"> </span><span class="hl-7">PUT</span><span class="hl-1"> </span><span class="hl-6">a</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">ruta</span><span class="hl-1"> </span><span class="hl-2">&quot;/users/:id&quot;</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">actualiza</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">información</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">usuario</span><span class="hl-1"> </span><span class="hl-6">específico</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1"> </span><span class="hl-6">utilizando</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">modelo</span><span class="hl-1"> </span><span class="hl-6">userModel</span><span class="hl-1">. </span><span class="hl-6">Si</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">parámetro</span><span class="hl-1"> </span><span class="hl-6">id</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">proporciona</span><span class="hl-1"> </span><span class="hl-6">como</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">consulta</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">solicitud</span><span class="hl-1">, </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">utiliza</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">método</span><span class="hl-1"> </span><span class="hl-0">findOneAndUpdate</span><span class="hl-1">() </span><span class="hl-6">del</span><span class="hl-1"> </span><span class="hl-6">modelo</span><span class="hl-1"> </span><span class="hl-6">userModel</span><span class="hl-1"> </span><span class="hl-6">para</span><span class="hl-1"> </span><span class="hl-6">buscar</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">actualizar</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">usuario</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-7">ID</span><span class="hl-1"> </span><span class="hl-6">especificado</span><span class="hl-1">. </span><span class="hl-6">Si</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">parámetro</span><span class="hl-1"> </span><span class="hl-6">id</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">proporciona</span><span class="hl-1"> </span><span class="hl-6">como</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">parte</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">ruta</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">solicitud</span><span class="hl-1">, </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">utiliza</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">método</span><span class="hl-1"> </span><span class="hl-0">findByIdAndUpdate</span><span class="hl-1">() </span><span class="hl-6">del</span><span class="hl-1"> </span><span class="hl-6">modelo</span><span class="hl-1"> </span><span class="hl-6">userModel</span><span class="hl-1"> </span><span class="hl-6">para</span><span class="hl-1"> </span><span class="hl-6">buscar</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">actualizar</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">usuario</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-7">ID</span><span class="hl-1"> </span><span class="hl-6">especificado</span><span class="hl-1">. </span><span class="hl-6">Si</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">actualización</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">realiza</span><span class="hl-1"> </span><span class="hl-6">correctamente</span><span class="hl-1">, </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1"> </span><span class="hl-6">devuelve</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">objeto</span><span class="hl-1"> </span><span class="hl-7">JSON</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">mensaje</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">confirmación</span><span class="hl-1">.</span><br/><span class="hl-1">- </span><span class="hl-10">deleteUser</span><span class="hl-1">: </span><span class="hl-6">Esta</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1"> </span><span class="hl-6">maneja</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">solicitud</span><span class="hl-1"> </span><span class="hl-7">DELETE</span><span class="hl-1"> </span><span class="hl-6">a</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">ruta</span><span class="hl-1"> </span><span class="hl-2">&quot;/users/:id&quot;</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">elimina</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">usuario</span><span class="hl-1"> </span><span class="hl-6">específico</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1"> </span><span class="hl-6">utilizando</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">modelo</span><span class="hl-1"> </span><span class="hl-6">userModel</span><span class="hl-1">. </span><span class="hl-6">Si</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">parámetro</span><span class="hl-1"> </span><span class="hl-6">id</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">proporciona</span><span class="hl-1"> </span><span class="hl-6">como</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">consulta</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">solicitud</span><span class="hl-1">, </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">utiliza</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">método</span><span class="hl-1"> </span><span class="hl-0">findOneAndDelete</span><span class="hl-1">() </span><span class="hl-6">del</span><span class="hl-1"> </span><span class="hl-6">modelo</span><span class="hl-1"> </span><span class="hl-6">userModel</span><span class="hl-1"> </span><span class="hl-6">para</span><span class="hl-1"> </span><span class="hl-6">buscar</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">eliminar</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">usuario</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-7">ID</span><span class="hl-1"> </span><span class="hl-6">especificado</span><span class="hl-1">. </span><span class="hl-6">Si</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">parámetro</span><span class="hl-1"> </span><span class="hl-6">id</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">proporciona</span><span class="hl-1"> </span><span class="hl-6">como</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">parte</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">ruta</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">solicitud</span><span class="hl-1">, </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">utiliza</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">método</span><span class="hl-1"> </span><span class="hl-0">findByIdAndDelete</span><span class="hl-1">() </span><span class="hl-6">del</span><span class="hl-1"> </span><span class="hl-6">modelo</span><span class="hl-1"> </span><span class="hl-6">userModel</span><span class="hl-1"> </span><span class="hl-6">para</span><span class="hl-1"> </span><span class="hl-6">buscar</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">eliminar</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">usuario</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-7">ID</span><span class="hl-1"> </span><span class="hl-6">especificado</span><span class="hl-1">. </span><span class="hl-6">Si</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">eliminación</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">realiza</span><span class="hl-1"> </span><span class="hl-6">correctamente</span><span class="hl-1">, </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1"> </span><span class="hl-6">devuelve</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">objeto</span><span class="hl-1"> </span><span class="hl-7">JSON</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">mensaje</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">confirmación</span><span class="hl-1">.</span><br/><span class="hl-1">- </span><span class="hl-10">addTrackToHistory</span><span class="hl-1">: </span><span class="hl-6">Esta</span><span class="hl-1"> </span><span class="hl-6">función</span><span class="hl-1"> </span><span class="hl-6">maneja</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">solicitud</span><span class="hl-1"> </span><span class="hl-7">POST</span><span class="hl-1"> </span><span class="hl-6">a</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">ruta</span><span class="hl-1"> </span><span class="hl-2">&quot;/users/:id/history&quot;</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">agrega</span><span class="hl-1"> </span><span class="hl-6">una</span><span class="hl-1"> </span><span class="hl-6">nueva</span><span class="hl-1"> </span><span class="hl-6">ruta</span><span class="hl-1"> </span><span class="hl-6">al</span><span class="hl-1"> </span><span class="hl-6">historial</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">rutas</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">un</span><span class="hl-1"> </span><span class="hl-6">usuario</span><span class="hl-1"> </span><span class="hl-6">identificado</span><span class="hl-1"> </span><span class="hl-6">por</span><span class="hl-1"> </span><span class="hl-6">su</span><span class="hl-1"> </span><span class="hl-2">&quot;id&quot;</span><span class="hl-1">. </span><span class="hl-6">La</span><span class="hl-1"> </span><span class="hl-6">nueva</span><span class="hl-1"> </span><span class="hl-6">ruta</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">agrega</span><span class="hl-1"> </span><span class="hl-6">al</span><span class="hl-1"> </span><span class="hl-6">final</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">lista</span><span class="hl-1"> </span><span class="hl-6">existente</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">rutas</span><span class="hl-1"> </span><span class="hl-6">del</span><span class="hl-1"> </span><span class="hl-6">usuario</span><span class="hl-1">.</span><br/><br/><span class="hl-1">### </span><span class="hl-6">Base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1"> &lt;</span><span class="hl-6">a</span><span class="hl-1"> </span><span class="hl-6">name</span><span class="hl-1">=</span><span class="hl-2">&quot;database&quot;</span><span class="hl-1">&gt;&lt;/</span><span class="hl-8">a</span><span class="hl-1">&gt;</span><br/><span class="hl-1">&gt; [</span><span class="hl-6">Volver</span><span class="hl-1"> </span><span class="hl-6">al</span><span class="hl-1"> </span><span class="hl-6">índice</span><span class="hl-1">](#</span><span class="hl-6">índice</span><span class="hl-1">)</span><br/><br/><span class="hl-1">&gt; </span><span class="hl-6">La</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1"> </span><span class="hl-6">contiene</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">información</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">aplicación</span><span class="hl-1">, </span><span class="hl-6">siendo</span><span class="hl-1"> </span><span class="hl-6">esta</span><span class="hl-1"> </span><span class="hl-6">las</span><span class="hl-1"> </span><span class="hl-6">rutas</span><span class="hl-1">, </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">retos</span><span class="hl-1">, </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">grupos</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">los</span><span class="hl-1"> </span><span class="hl-6">usuarios</span><span class="hl-1">.</span><br/><br/><span class="hl-6">La</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1"> </span><span class="hl-6">que</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">ha</span><span class="hl-1"> </span><span class="hl-6">utilizado</span><span class="hl-1"> </span><span class="hl-6">para</span><span class="hl-1"> </span><span class="hl-6">este</span><span class="hl-1"> </span><span class="hl-6">proyecto</span><span class="hl-1"> </span><span class="hl-6">es</span><span class="hl-1"> </span><span class="hl-6">MongoDB</span><span class="hl-1">. </span><span class="hl-6">Para</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">conexión</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">ha</span><span class="hl-1"> </span><span class="hl-6">utilizado</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">paquete</span><span class="hl-1"> </span><span class="hl-6">mongoose</span><span class="hl-1">. </span><span class="hl-6">La</span><span class="hl-1"> </span><span class="hl-6">configuración</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">encuentra</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-6">fichero</span><span class="hl-1"> </span><span class="hl-6">mongoose</span><span class="hl-1">.</span><span class="hl-6">ts</span><span class="hl-1"> </span><span class="hl-6">que</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">encuentra</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">carpeta</span><span class="hl-1"> </span><span class="hl-6">database</span><span class="hl-1">. </span><span class="hl-6">En</span><span class="hl-1"> </span><span class="hl-6">este</span><span class="hl-1"> </span><span class="hl-6">fichero</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">realiza</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">conexión</span><span class="hl-1"> </span><span class="hl-6">con</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1"> </span><span class="hl-6">y</span><span class="hl-1"> </span><span class="hl-6">se</span><span class="hl-1"> </span><span class="hl-6">exporta</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">conexión</span><span class="hl-1"> </span><span class="hl-6">para</span><span class="hl-1"> </span><span class="hl-6">que</span><span class="hl-1"> </span><span class="hl-6">pueda</span><span class="hl-1"> </span><span class="hl-6">ser</span><span class="hl-1"> </span><span class="hl-6">utilizada</span><span class="hl-1"> </span><span class="hl-6">en</span><span class="hl-1"> </span><span class="hl-6">otros</span><span class="hl-1"> </span><span class="hl-6">ficheros</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">aplicación</span><span class="hl-1">.</span><br/><br/><span class="hl-6">El</span><span class="hl-1"> </span><span class="hl-6">contenido</span><span class="hl-1"> </span><span class="hl-6">del</span><span class="hl-1"> </span><span class="hl-6">fichero</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">configuración</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">la</span><span class="hl-1"> </span><span class="hl-6">base</span><span class="hl-1"> </span><span class="hl-6">de</span><span class="hl-1"> </span><span class="hl-6">datos</span><span class="hl-1"> </span><span class="hl-6">mongoose</span><span class="hl-1">.</span><span class="hl-6">ts</span><span class="hl-1"> </span><span class="hl-6">es</span><span class="hl-1"> </span><span class="hl-6">el</span><span class="hl-1"> </span><span class="hl-10">siguiente</span><span class="hl-1">:</span><br/><br/><span class="hl-2">````</span><span class="hl-6">typescript</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">connect</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;mongoose&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">connect</span><span class="hl-1">(</span><span class="hl-2">&#39;mongodb://127.0.0.1:27017/student&#39;</span><span class="hl-1">).</span><span class="hl-0">then</span><span class="hl-1">(() </span><span class="hl-4">=&gt;</span><span class="hl-1"> {  *********************************</span><br/><span class="hl-1">  </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Connected to the database&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">}).</span><span class="hl-0">catch</span><span class="hl-1">(() </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Something went wrong when conecting to the database&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">});</span>
</code></pre>
<p>Su código se encarga de establecer una conexión con una base de datos MongoDB utilizando Mongoose, una biblioteca de objetos de modelado de MongoDB para Node.js.</p>
<p>La conexión se establece utilizando la función connect() de Mongoose, que recibe como argumento una cadena de conexión URI a la base de datos MongoDB. En este caso, la cadena de conexión especifica que se utilizará una base de datos llamada &quot;student&quot; en la dirección IP &quot;127.0.0.1&quot; y el puerto &quot;27017&quot;. &quot;127.0.0.1&quot; es la dirección IP local, que indica que la base de datos se encuentra en la misma máquina que el servidor Node.js.</p>
<p>La función connect() devuelve una promesa, que se maneja con la función then() y catch(). Si la conexión se establece correctamente, se ejecuta la función then() y se escribe en la consola el mensaje &quot;Connected to the database&quot;. Si hay algún error al conectarse a la base de datos, se ejecuta la función catch() y se escribe en la consola el mensaje &quot;Something went wrong when connecting to the database&quot;.</p>
<p>Además, se ha hecho uso de MongoDB Atlas para poder desplegar la aplicación en Cyclic. Para ello, se ha creado una base de datos en MongoDB Atlas y se ha cambiado la cadena de conexión URI a la base de datos MongoDB.</p>

<a href="#programa-principal-" id="programa-principal-" style="color: inherit; text-decoration: none;">
  <h3>Programa principal <a name="principal"></a></h3>
</a>
<blockquote>
<p><a href="#%C3%ADndice">Volver al índice</a></p>
</blockquote>
<blockquote>
<p>El programa principal es el fichero index.ts que se encuentra en la carpeta src. En este fichero se encuentra el código principal de la aplicación. En este fichero se importan las rutas de la aplicación y se crea el servidor. El contenido del fichero index.ts es el siguiente:</p>
</blockquote>
<pre><code class="language-typescript"><span class="hl-5">import</span><span class="hl-1"> </span><span class="hl-6">express</span><span class="hl-1"> </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;express&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> </span><span class="hl-6">cors</span><span class="hl-1"> </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;cors&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> { </span><span class="hl-6">connect</span><span class="hl-1"> } </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;mongoose&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> </span><span class="hl-6">usersRouter</span><span class="hl-1"> </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;./routes/userRouter.js&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> </span><span class="hl-6">trackRouter</span><span class="hl-1"> </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;./routes/trackRouter.js&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> </span><span class="hl-6">groupRouter</span><span class="hl-1"> </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;./routes/groupRouter.js&#39;</span><span class="hl-1">;</span><br/><span class="hl-5">import</span><span class="hl-1"> </span><span class="hl-6">challengeRouter</span><span class="hl-1"> </span><span class="hl-5">from</span><span class="hl-1"> </span><span class="hl-2">&#39;./routes/challengeRouter.js&#39;</span><span class="hl-1">;</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">app</span><span class="hl-1"> = </span><span class="hl-0">express</span><span class="hl-1">();</span><br/><br/><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-0">use</span><span class="hl-1">(</span><span class="hl-0">cors</span><span class="hl-1">());</span><br/><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-0">use</span><span class="hl-1">(</span><span class="hl-6">express</span><span class="hl-1">.</span><span class="hl-0">json</span><span class="hl-1">());</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">uri</span><span class="hl-1"> =</span><span class="hl-2">&quot;mongodb+srv://user:user123ASDFG@cluster0.mow4vh4.mongodb.net/?retryWrites=true&amp;w=majority&quot;</span><span class="hl-1">;</span><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">uriLocal</span><span class="hl-1"> = </span><span class="hl-2">&quot;mongodb://127.0.0.1:27017/destravate&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">connect</span><span class="hl-1">(</span><span class="hl-6">uriLocal</span><span class="hl-1">).</span><span class="hl-0">then</span><span class="hl-1">(() </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Connection to MongoDB server established&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">}).</span><span class="hl-0">catch</span><span class="hl-1">(() </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Unable to connect to MongoDB server&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-0">use</span><span class="hl-1">(</span><span class="hl-2">&#39;/users&#39;</span><span class="hl-1">, </span><span class="hl-6">usersRouter</span><span class="hl-1">);</span><br/><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-0">use</span><span class="hl-1">(</span><span class="hl-2">&#39;/tracks&#39;</span><span class="hl-1">, </span><span class="hl-6">trackRouter</span><span class="hl-1">);</span><br/><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-0">use</span><span class="hl-1">(</span><span class="hl-2">&#39;/groups&#39;</span><span class="hl-1">, </span><span class="hl-6">groupRouter</span><span class="hl-1">);</span><br/><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-0">use</span><span class="hl-1">(</span><span class="hl-2">&#39;/challenges&#39;</span><span class="hl-1">, </span><span class="hl-6">challengeRouter</span><span class="hl-1">);</span><br/><br/><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-0">use</span><span class="hl-1">(</span><span class="hl-2">&#39;/&#39;</span><span class="hl-1">, (</span><span class="hl-6">req</span><span class="hl-1">, </span><span class="hl-6">res</span><span class="hl-1">) </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-6">res</span><span class="hl-1">.</span><span class="hl-0">send</span><span class="hl-1">(</span><span class="hl-2">&#39;Hello World!&#39;</span><span class="hl-1">);</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">const</span><span class="hl-1"> </span><span class="hl-7">PORT</span><span class="hl-1"> = </span><span class="hl-6">process</span><span class="hl-1">.</span><span class="hl-6">env</span><span class="hl-1">.</span><span class="hl-7">PORT</span><span class="hl-1"> || </span><span class="hl-9">4000</span><span class="hl-1">;</span><br/><br/><span class="hl-6">app</span><span class="hl-1">.</span><span class="hl-0">listen</span><span class="hl-1">(</span><span class="hl-7">PORT</span><span class="hl-1">, () </span><span class="hl-4">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">`Server running on port </span><span class="hl-4">${</span><span class="hl-7">PORT</span><span class="hl-4">}</span><span class="hl-2">`</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span><br/><br/><span class="hl-6">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-6">Date</span><span class="hl-1">.</span><span class="hl-0">now</span><span class="hl-1">())</span><br/><br/><span class="hl-5">export</span><span class="hl-1"> </span><span class="hl-5">default</span><span class="hl-1"> </span><span class="hl-6">app</span><span class="hl-1">;</span>
</code></pre>
<p>Este código representa a nuestra aplicación de servidor Node.js, que utiliza el Express para manejar las solicitudes HTTP y la biblioteca Mongoose para conectarse a una base de datos MongoDB.</p>
<p>Primero, se importan los módulos necesarios, incluyendo Express, Cors y Mongoose, así como los enrutadores de usuario, track, group y challenge desde los archivos de ruta correspondientes. A continuación, se crea una instancia de la aplicación Express utilizando la función express().</p>
<p>Luego, se configura la aplicación para utilizar el middleware Cors y parsear solicitudes entrantes en formato JSON utilizando las funciones app.use(cors()) y app.use(express.json()), respectivamente.</p>
<p>Se establece la cadena de conexión a la base de datos MongoDB en la variable uriLocal, y se utiliza la función connect() de Mongoose para conectar la aplicación a la base de datos especificada. Si la conexión se establece correctamente, se escribe en la consola el mensaje &quot;Connection to MongoDB server established&quot;. Si hay algún error al conectarse a la base de datos, se escribe en la consola el mensaje &quot;Unable to connect to MongoDB server&quot;.</p>
<p>A continuación, se especifican las rutas para los enrutadores de usuario, track, group y challenge utilizando la función app.use(). Se establece una ruta de inicio simple que devuelve el mensaje &quot;Hello World!&quot; para cualquier solicitud en la ruta raíz (&#39;/&#39;).</p>
<p>Por último, se establece el puerto en el que se ejecutará el servidor. Si una variable de entorno PORT está definida, se utiliza su valor. De lo contrario, se utiliza el valor 4000. El servidor se inicia con la función app.listen(), y se escribe en la consola el mensaje &quot;Server running on port <PORT>&quot;.</p>
<p>Finalmente, la instancia de la aplicación se exporta para que pueda ser utilizada en otros archivos.</p>

<a href="#conclusiones-" id="conclusiones-" style="color: inherit; text-decoration: none;">
  <h3>Conclusiones <a name="conclusiones"></a></h3>
</a>
<blockquote>
<p><a href="#%C3%ADndice">Volver al índice</a></p>
</blockquote>
<p>De este proyecto se pueden extraer varias conclusiones y aprendizajes, entre los que destacan:</p>
<ul>
<li>La importancia de la documentación y la planificación previa a la implementación de un proyecto.</li>
<li>La importancia de la organización y la estructuración del código.</li>
<li>La importancia de la utilización de herramientas de control de versiones como Git.</li>
</ul>
<p>Además, se han adquirido conocimientos sobre:</p>
<ul>
<li>El lenguaje de programación TypeScript.</li>
<li>El framework Express.</li>
<li>La biblioteca Mongoose.</li>
<li>La base de datos MongoDB.</li>
<li>El lenguaje de consultas MongoDB.</li>
<li>El uso de la herramienta Thunder Client para realizar peticiones HTTP.</li>
</ul>

<a href="#referencias-" id="referencias-" style="color: inherit; text-decoration: none;">
  <h3>Referencias <a name="referencias"></a></h3>
</a>
<blockquote>
<p><a href="#%C3%ADndice">Volver al índice</a></p>
</blockquote>
<ol>
<li><a href="https://www.npmjs.com/package/prompt-sync">Entrada de texto</a></li>
<li><a href="https://es.wikipedia.org/wiki/C%C3%B3digo_escape_ANSI#:~:text=Los%20c%C3%B3digos%20de%20escape%20ANSI,color%20o%20moviendo%20el%20cursor.">Formato de escape ANSI</a></li>
<li><a href="https://nodejs.org/es/docs/">Documentación oficial de Node.js</a></li>
<li><a href="https://www.typescriptlang.org/docs/">Documentación de TypeScript</a></li>
<li><a href="https://github.com/SBoudrias/Inquirer.js#documentation">Documentación de Inquirer.js</a></li>
<li><a href="https://github.com/typicode/lowdb#usage">Documentación de Lowdb</a></li>
<li><a href="https://typedoc.org/">Documentación de TypeDoc</a></li>
<li><a href="https://jestjs.io/docs/getting-started">Libro &quot;Essential TypeScript: From Beginner to Pro&quot; de Adam FreemanPruebas unitarias con Jest</a></li>
<li><a href="https://coveralls.io/">Coveralls</a></li>
<li><a href="https://docs.github.com/es/actions">Integración continua con GitHub Actions</a></li>
<li><a href="https://sonarcloud.io/documentation">Calidad del código con SonarCloud</a></li>
</ol>

<a href="#asignación-de-classroom-" id="asignación-de-classroom-" style="color: inherit; text-decoration: none;">
  <h3>Asignación de Classroom <a name="assignment"></a></h3>
</a>
<blockquote>
<p><a href="#%C3%ADndice">Volver al índice</a>
<a href="https://classroom.github.com/a/GwypoZrl"><img src="https://classroom.github.com/assets/deadline-readme-button-24ddc0f5d75046c5622901739e7c5dd533143b0c8e959d652212380cedb1ea36.svg" alt="Review Assignment Due Date"></a></p>
</blockquote>
</div></div>
<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
<div class="tsd-navigation settings">
<details class="tsd-index-accordion"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Settings</h3></summary>
<div class="tsd-accordion-details">
<div class="tsd-filter-visibility">
<h4 class="uppercase">Member Visibility</h4><form>
<ul id="tsd-filter-options">
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div>
<div class="tsd-theme-toggle">
<h4 class="uppercase">Theme</h4><select id="theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div>
<nav class="tsd-navigation primary">
<details class="tsd-index-accordion" open><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)"></path></svg> Modules</h3></summary>
<div class="tsd-accordion-details">
<ul>
<li class="current selected"><a href="modules.html">practica11</a>
<ul></ul></li></ul></div></details></nav>
<nav class="tsd-navigation secondary menu-sticky">
<ul>
<li class="tsd-kind-function"><a href="functions/default.html" class="tsd-index-link"><svg class="tsd-kind-icon" width="24" height="24" viewBox="0 0 24 24"><rect fill="var(--color-icon-background)" stroke="var(--color-ts-function)" stroke-width="1.5" x="1" y="1" width="22" height="22" rx="6" id="icon-64-path"></rect><path d="M9.39 16V7.24H14.55V8.224H10.446V11.128H14.238V12.112H10.47V16H9.39Z" fill="var(--color-text)" id="icon-64-text"></path></svg>default</a></li></ul></nav></div></div>
<div class="container tsd-generator">
<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div>
<div class="overlay"></div><script src="assets/main.js"></script></body></html>